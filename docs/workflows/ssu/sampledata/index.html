<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="description" content="Workflow for wrangling sample metadata and generating informative sample names.">
<title>1. Sample Metadata – TransIsthmian Shrimp</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../workflows/ssu/dada2/index.html" rel="next">
<link href="../../../workflows/ssu/index.html" rel="prev">
<link href="../../../assets/favicon.ico" rel="icon">
<script src="../../../site_libs/quarto-listing/list.min.js"></script>
<script src="../../../site_libs/quarto-listing/quarto-listing.js"></script>
<script src="../../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-dark-707d8167ce6003fca903bfe2be84ab7f.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap-e6bd33826d752a752b088f17960ea970.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../../site_libs/bootstrap/bootstrap-dark-d7d32a8442357cea8cf74a4a848b80d6.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../../../site_libs/bootstrap/bootstrap-e6bd33826d752a752b088f17960ea970.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script>

  window.document.addEventListener("DOMContentLoaded", function (_event) {
    const listingTargetEl = window.document.querySelector('#listing-sd-listing .list');
    if (!listingTargetEl) {
      // No listing discovered, do not attach.
      return; 
    }

    const options = {
      valueNames: ['listing-filename','listing-description',{ data: ['index'] },{ data: ['categories'] },{ data: ['listing-filename-sort'] }],
      
      searchColumns: ["listing-filename","listing-description"],
    };

    window['quarto-listings'] = window['quarto-listings'] || {};
    window['quarto-listings']['listing-sd-listing'] = new List('listing-sd-listing', options);

    if (window['quarto-listing-loaded']) {
      window['quarto-listing-loaded']();
    }
  });

  window.addEventListener('hashchange',() => {
    if (window['quarto-listing-loaded']) {
      window['quarto-listing-loaded']();
    }
  })
  </script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="../../../assets/css/styles.css">
</head>
<body class="nav-sidebar floating nav-fixed quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../../images/icon.png" alt="Istmobiome logo." class="navbar-logo light-content"><img src="../../../images/icon.png" alt="Istmobiome logo." class="navbar-logo dark-content"></a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link active" href="../../../index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../workflows/portal/index.html"> 
<span class="menu-text">Data Portal</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../workflows/ssu/index.html"> 
<span class="menu-text">16S rRNA</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../workflows/mg/index.html"> 
<span class="menu-text">Metagenomics</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../workflows/pub/index.html"> 
<span class="menu-text">Paper</span></a>
  </li>  
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item compact">
    <a class="nav-link" href="https://github.com/istmobiome/trans-shrimp/"> <i class="bi bi-github" role="img" aria-label="Trans Shrimp">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../../workflows/ssu/index.html">16S rRNA</a></li><li class="breadcrumb-item"><a href="../../../workflows/ssu/sampledata/index.html">1. Sample Metadata</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav></header><!-- content --><header id="title-block-header" class="quarto-title-block default page-columns page-full"><div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../../workflows/ssu/index.html">16S rRNA</a></li><li class="breadcrumb-item"><a href="../../../workflows/ssu/sampledata/index.html">1. Sample Metadata</a></li></ol></nav>
      <div class="quarto-title-block"><div><h1 class="title">1. Sample Metadata</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i></button></div></div>
                  <div>
        <div class="description">
          <p>Workflow for wrangling sample metadata and generating informative sample names.</p>
        </div>
      </div>
                </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="../../../index.html" class="sidebar-logo-link">
      </a>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../workflows/portal/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Portal</span></a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../workflows/ssu/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">16S rRNA</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../workflows/ssu/sampledata/index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">1. Sample Metadata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../workflows/ssu/dada2/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2. DADA2 ASV Workflow</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../workflows/ssu/otu/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4. OTU Workflow</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../workflows/ssu/med/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5. MED Workflow</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../workflows/mg/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Metagenomics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../workflows/mg/setup/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1. Build Databases</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../workflows/mg/assembly/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2. Co-Assembly &amp; Annotations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../workflows/mg/aa-results/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3. Assembly &amp; Annotation Results</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../workflows/pub/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Publication Material</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../workflows/pub/references/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Workflow References</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../workflows/pub/archive_data/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Submitting &amp; Archiving Data/Code</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="1"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#workflow-input" id="toc-workflow-input" class="nav-link active" data-scroll-target="#workflow-input">Workflow Input</a></li>
  <li><a href="#overview" id="toc-overview" class="nav-link" data-scroll-target="#overview">Overview</a></li>
  <li><a href="#curate-metadata" id="toc-curate-metadata" class="nav-link" data-scroll-target="#curate-metadata">Curate Metadata</a></li>
  <li>
<a href="#sample-shortcodes" id="toc-sample-shortcodes" class="nav-link" data-scroll-target="#sample-shortcodes">Sample Shortcodes</a>
  <ul class="collapse">
<li><a href="#control-samples" id="toc-control-samples" class="nav-link" data-scroll-target="#control-samples">Control samples</a></li>
  <li><a href="#environmental-samples" id="toc-environmental-samples" class="nav-link" data-scroll-target="#environmental-samples">Environmental samples</a></li>
  <li><a href="#shrimp-samples" id="toc-shrimp-samples" class="nav-link" data-scroll-target="#shrimp-samples">Shrimp samples</a></li>
  </ul>
</li>
  <li><a href="#modified-metadata" id="toc-modified-metadata" class="nav-link" data-scroll-target="#modified-metadata">Modified Metadata</a></li>
  <li><a href="#rename-fastq-files" id="toc-rename-fastq-files" class="nav-link" data-scroll-target="#rename-fastq-files">Rename FastQ Files</a></li>
  <li><a href="#save-sample-data" id="toc-save-sample-data" class="nav-link" data-scroll-target="#save-sample-data">Save Sample Data</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/istmobiome/trans-shrimp/blob/main/workflows/ssu/sampledata/index.qmd" target="_blank" class="toc-action"><i class="bi bi-github"></i>View source</a></li><li><a href="https://github.com/istmobiome/trans-shrimp/edit/main/workflows/ssu/sampledata/index.qmd" target="_blank" class="toc-action"><i class="bi empty"></i>Edit this page</a></li><li><a href="https://github.com/istmobiome/trans-shrimp/issues/new" target="_blank" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content"><section id="workflow-input" class="level2 page-columns page-full"><h2 class="anchored" data-anchor-id="workflow-input">Workflow Input</h2>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Data &amp; Scripts
</div>
</div>
<div class="callout-body-container callout-body">
<p>The table below contains links to files and scripts needed to run this workflow–specifically the <code>sampledata_processing.zip</code> archive which contains the necessary assets. Also included are the sample data tables generated at the end of the pipeline.</p>
</div>
</div>
<div id="listing-sd-listing" class="column-body quarto-listing quarto-listing-container-table">
<table class="quarto-listing-table table">
<thead><tr>
<th>
File Name
</th>

<th>
Description
</th>

</tr></thead>
<tbody class="list">
<tr data-index="0" data-listing-filename-sort="sampledata_processing.zip">
<td>
<a href="../../../share/ssu/sampledata/sampledata_processing.zip" class="filename listing-filename">sampledata_processing.zip</a>
</td>
<td>
<span class="listing-description">Archive contains metadata and fastq rename lookup files for all six sequencing runs, the bash renaming script, and the fastq_info.txt file. </span>
</td>

</tr>
<tr data-index="1" data-listing-filename-sort="all_metadata.txt">
<td>
<a href="../../../share/ssu/sampledata/all_metadata.txt" class="filename listing-filename">all_metadata.txt</a>
</td>
<td>
<span class="listing-description">Complete sample metadata table. </span>
</td>

</tr>
<tr data-index="2" data-listing-filename-sort="sample_data.rds">
<td>
<a href="../../../share/ssu/sampledata/sample_data.rds" class="filename listing-filename">sample_data.rds</a>
</td>
<td>
<span class="listing-description">RDS file of sample dataframe that contains only the most relevant metadata for downstream analyses. </span>
</td>

</tr>
<tr data-index="3" data-listing-filename-sort="sample_data.txt">
<td>
<a href="../../../share/ssu/sampledata/sample_data.txt" class="filename listing-filename">sample_data.txt</a>
</td>
<td>
<span class="listing-description">Tab delimited text file version of sample dataframe that contains only the most relevant metadata for downstream analyses. </span>
</td>

</tr>
</tbody>
</table>
<div class="listing-no-matching d-none">No matching items</div>
</div>
</section><section id="overview" class="level2"><h2 class="anchored" data-anchor-id="overview">Overview</h2>
<p>This workflow is designed to process our raw metadata files and generate more informative sample names. Our aim is to standardize metadata entries, generate new sample names, and save sample data frames that are used in downstream analyses.</p>
</section><section id="curate-metadata" class="level2"><h2 class="anchored" data-anchor-id="curate-metadata">Curate Metadata</h2>
<p>The first step in to load all metadata files (one for each sequencing run) and combine the files.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">file_paths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span>path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="va">work_here</span>, <span class="st">"/metadata_files"</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                         pattern <span class="op">=</span> <span class="st">"\\.csv$"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">tmp_meta</span> <span class="op">&lt;-</span> <span class="fu">vroom</span><span class="fu">::</span><span class="fu"><a href="https://vroom.r-lib.org/reference/vroom.html">vroom</a></span><span class="op">(</span><span class="va">file_paths</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">tmp_meta</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Original_name"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Next we remove any duplicate entries. We have duplicates because some samples were sequenced more than once due to low read count from the initial run.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dups_in_md</span> <span class="op">&lt;-</span> <span class="va">tmp_meta</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/duplicated.html">duplicated</a></span><span class="op">(</span><span class="va">tmp_meta</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="va">tmp_meta</span> <span class="op">&lt;-</span> <span class="va">tmp_meta</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/duplicated.html">duplicated</a></span><span class="op">(</span><span class="va">tmp_meta</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,<span class="op">]</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Next we remove several samples due to low initial read count. We pulled these out before doing any renaming, processing, etc. so they are only listed in the metadata files.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#### Regex Code for partial matches</span></span>
<span><span class="va">tmp_lc_samp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"7512"</span>, <span class="st">"8978-S"</span>, <span class="st">"8978-H"</span>, <span class="st">"7640-S"</span><span class="op">)</span></span>
<span><span class="va">tmp_meta</span> <span class="op">&lt;-</span> <span class="va">tmp_meta</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">tmp_lc_samp</span>, collapse <span class="op">=</span> <span class="st">"|"</span><span class="op">)</span>, </span>
<span>                            <span class="va">tmp_meta</span><span class="op">$</span><span class="va">Original_name</span><span class="op">)</span>, <span class="op">]</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>And finally do a little maintenance on column names. What we are after here is standardized column names without spaces, periods, dashes, etc.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">tmp_meta</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"-| |\\.+"</span>, <span class="st">"_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">tmp_meta</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">tmp_meta</span><span class="op">)</span><span class="op">[</span><span class="fl">12</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Species_pair"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">tmp_meta</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"_Original"</span>, <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">tmp_meta</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Once this is finished we can go ahead and select columns in the metadata that are most important for downstream analysis.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tmp_meta</span> <span class="op">&lt;-</span> <span class="va">tmp_meta</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ocean"</span>, <span class="st">"Morphospecies"</span>, <span class="st">"Tissue"</span>, </span>
<span>                    <span class="st">"Habitat"</span>, <span class="st">"Site"</span>, <span class="st">"Site_2"</span>, <span class="st">"Taxon"</span>, </span>
<span>                    <span class="st">"Length"</span>, <span class="st">"Station_no"</span>, <span class="st">"Species_pair"</span>, </span>
<span>                    <span class="st">"Species_group"</span>, <span class="st">"Species_complex"</span>, </span>
<span>                    <span class="st">"Plate"</span>, <span class="st">"Row"</span>, <span class="st">"Column"</span><span class="op">)</span>, </span>
<span>                  .after <span class="op">=</span> <span class="st">"Original_name"</span><span class="op">)</span></span>
<span><span class="va">tmp_meta</span><span class="op">[</span><span class="fl">17</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">tmp_meta</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>At this point we need to standardize some of the values in the metadata categories. This includes things like replacing spaces with underscores (<code>_</code>). The goal here is to eliminate anything that may cause issues later in the workflows.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tmp_meta</span> <span class="op">&lt;-</span> <span class="va">tmp_meta</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># Fix specific replacements</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    Ocean <span class="op">=</span> <span class="fu">str_replace_all</span><span class="op">(</span><span class="va">Ocean</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"Pacific"</span> <span class="op">=</span> <span class="st">"Eastern_Pacific"</span>,</span>
<span>      <span class="st">"Western Atlantic"</span> <span class="op">=</span> <span class="st">"Western_Atlantic"</span></span>
<span>    <span class="op">)</span><span class="op">)</span>,</span>
<span>    Taxon <span class="op">=</span> <span class="fu">str_replace_all</span><span class="op">(</span><span class="va">Taxon</span>, <span class="st">"Snapping shrimp"</span>, <span class="st">"Snapping_shrimp"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  </span>
<span>  <span class="co"># Normalize text by replacing spaces/dots in multiple columns</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    Morphospecies <span class="op">=</span> <span class="fu">str_replace_all</span><span class="op">(</span><span class="va">Morphospecies</span>, <span class="st">" +"</span>, <span class="st">"_"</span><span class="op">)</span>,</span>
<span>    Species_pair  <span class="op">=</span> <span class="fu">str_replace_all</span><span class="op">(</span><span class="va">Species_pair</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"\\. +"</span> <span class="op">=</span> <span class="st">"_"</span>,</span>
<span>      <span class="st">" / "</span>   <span class="op">=</span> <span class="st">"-"</span>,</span>
<span>      <span class="st">" +"</span>    <span class="op">=</span> <span class="st">"_"</span></span>
<span>    <span class="op">)</span><span class="op">)</span>,</span>
<span>    Species_group   <span class="op">=</span> <span class="fu">str_replace_all</span><span class="op">(</span><span class="va">Species_group</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"\\. "</span> <span class="op">=</span> <span class="st">"_"</span>, <span class="st">" "</span> <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    Species_complex <span class="op">=</span> <span class="fu">str_replace_all</span><span class="op">(</span><span class="va">Species_complex</span>, <span class="st">"\\. "</span>, <span class="st">"_"</span><span class="op">)</span>,</span>
<span>    Habitat   <span class="op">=</span> <span class="fu">str_replace_all</span><span class="op">(</span><span class="va">Habitat</span>, <span class="st">" +"</span>, <span class="st">"_"</span><span class="op">)</span>,</span>
<span>    Site      <span class="op">=</span> <span class="fu">str_replace_all</span><span class="op">(</span><span class="va">Site</span>, <span class="st">" +"</span>, <span class="st">"_"</span><span class="op">)</span>,</span>
<span>    Site_2    <span class="op">=</span> <span class="fu">str_replace_all</span><span class="op">(</span><span class="va">Site_2</span>, <span class="st">" +"</span>, <span class="st">"_"</span><span class="op">)</span>,</span>
<span>    Plate     <span class="op">=</span> <span class="fu">str_replace_all</span><span class="op">(</span><span class="va">Plate</span>, <span class="st">" "</span>, <span class="st">"_"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  </span>
<span>  <span class="co"># Map multiple Taxon values to "Environmental"</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    Taxon <span class="op">=</span> <span class="fu">str_replace_all</span><span class="op">(</span><span class="va">Taxon</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"Rubble"</span>   <span class="op">=</span> <span class="st">"Environmental"</span>, </span>
<span>      <span class="st">"Sediment"</span> <span class="op">=</span> <span class="st">"Environmental"</span>, </span>
<span>      <span class="st">"Mud"</span>      <span class="op">=</span> <span class="st">"Environmental"</span>,</span>
<span>      <span class="st">"Water"</span>    <span class="op">=</span> <span class="st">"Environmental"</span></span>
<span>    <span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Replace NA in Morphospecies with "Environmental"</span></span>
<span><span class="va">tmp_meta</span> <span class="op">&lt;-</span> <span class="va">tmp_meta</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>Morphospecies <span class="op">=</span> <span class="fu">replace_na</span><span class="op">(</span><span class="va">Morphospecies</span>, <span class="st">"Environmental"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section><section id="sample-shortcodes" class="level2"><h2 class="anchored" data-anchor-id="sample-shortcodes">Sample Shortcodes</h2>
<p>Next we want to create more meaningful sample names. For this we generate some <em>shortcodes</em> that capture key information about each sample, specifically:</p>
<ul>
<li>the sampling ocean</li>
<li>the species name</li>
<li>the tissue type</li>
</ul>
<p>These we will combine with the unique individual ID number to get the new name.</p>
<p>For example, something like <code>EP_A_HEBE_GL_8937</code> is the gill tissue (<strong>GL</strong>) from an <em>Alpheus hebes</em> (<strong>A-HEBE</strong>), individual ID <strong>8937</strong>, collected in the Eastern Pacific (<strong>EP</strong>).</p>
<p>We use a similar convention for environmental samples, but instead of species name, we use <code>E_SAMP</code> to delineate environmental samples. For example, <code>WA_E_SAMP_WT_3075</code> is a water sample (<strong>WT</strong>) collected from the Western Atlantic (<strong>WA</strong>), unique id <strong>3075</strong>.</p>
<div class="cell">
<details class="code-fold"><summary>Click to see the the shortcodes for each variable.</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tmp_ocean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"Control"</span> <span class="op">=</span> <span class="st">"CON"</span>,</span>
<span>  <span class="st">"Eastern_Pacific"</span> <span class="op">=</span> <span class="st">"EP"</span>,</span>
<span>  <span class="st">"Western_Atlantic"</span> <span class="op">=</span> <span class="st">"WA"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">tmp_tissue</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"Control"</span> <span class="op">=</span> <span class="st">"CON"</span>, </span>
<span>  <span class="st">"Egg"</span> <span class="op">=</span> <span class="st">"EG"</span>, </span>
<span>  <span class="st">"Gill"</span> <span class="op">=</span> <span class="st">"GL"</span>, </span>
<span>  <span class="st">"Hepatopancreas"</span> <span class="op">=</span> <span class="st">"HP"</span>, </span>
<span>  <span class="st">"Midgut"</span> <span class="op">=</span> <span class="st">"MG"</span>, </span>
<span>  <span class="st">"Stomach"</span> <span class="op">=</span> <span class="st">"ST"</span>, </span>
<span>  <span class="st">"Mud"</span> <span class="op">=</span> <span class="st">"MD"</span>, </span>
<span>  <span class="st">"Rubble"</span> <span class="op">=</span> <span class="st">"RB"</span>, </span>
<span>  <span class="st">"Sediment"</span> <span class="op">=</span> <span class="st">"SD"</span>, </span>
<span>  <span class="st">"Water"</span> <span class="op">=</span> <span class="st">"WT"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">tmp_species</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"Control"</span> <span class="op">=</span> <span class="st">"CON"</span>, </span>
<span>  <span class="st">"Alpheus_arenensis"</span> <span class="op">=</span> <span class="st">"A_AREN"</span>, </span>
<span>  <span class="st">"Alpheus_bahamensis"</span> <span class="op">=</span> <span class="st">"A_BAHA"</span>, </span>
<span>  <span class="st">"Alpheus_bouvieri"</span> <span class="op">=</span> <span class="st">"A_BOUV"</span>, </span>
<span>  <span class="st">"Alpheus_cristulifrons"</span> <span class="op">=</span> <span class="st">"A_CRIS"</span>, </span>
<span>  <span class="st">"Alpheus_fasciatus"</span> <span class="op">=</span> <span class="st">"A_FASC"</span>, </span>
<span>  <span class="st">"Alpheus_floridanus"</span> <span class="op">=</span> <span class="st">"A_FLOR"</span>, </span>
<span>  <span class="st">"Alpheus_formosus"</span> <span class="op">=</span> <span class="st">"A_FORM"</span>, </span>
<span>  <span class="st">"Alpheus_galapagensis"</span> <span class="op">=</span> <span class="st">"A_GALA"</span>, </span>
<span>  <span class="st">"Alpheus_hebes"</span> <span class="op">=</span> <span class="st">"A_HEBE"</span>, </span>
<span>  <span class="st">"Alpheus_hephaestus"</span> <span class="op">=</span> <span class="st">"A_HEPH"</span>, </span>
<span>  <span class="st">"Alpheus_hyeyoungae"</span> <span class="op">=</span> <span class="st">"A_HYEY"</span>, </span>
<span>  <span class="st">"Alpheus_javieri"</span> <span class="op">=</span> <span class="st">"A_JAVI"</span>, </span>
<span>  <span class="st">"Alpheus_millsae"</span> <span class="op">=</span> <span class="st">"A_MILL"</span>, </span>
<span>  <span class="st">"Alpheus_nuttingi"</span> <span class="op">=</span> <span class="st">"A_NUTT"</span>, </span>
<span>  <span class="st">"Alpheus_panamensis"</span> <span class="op">=</span> <span class="st">"A_PANA"</span>, </span>
<span>  <span class="st">"Alpheus_paracrinitus_no_spot"</span> <span class="op">=</span> <span class="st">"A_PCNS"</span>, </span>
<span>  <span class="st">"Alpheus_paracrinitus_with_spot"</span> <span class="op">=</span> <span class="st">"A_PCWS"</span>, </span>
<span>  <span class="st">"Alpheus_paraformosus"</span> <span class="op">=</span> <span class="st">"A_PARA"</span>, </span>
<span>  <span class="st">"Alpheus_platycheirus"</span> <span class="op">=</span> <span class="st">"A_PLAT"</span>, </span>
<span>  <span class="st">"Alpheus_rostratus"</span> <span class="op">=</span> <span class="st">"A_ROST"</span>, </span>
<span>  <span class="st">"Alpheus_saxidomus"</span> <span class="op">=</span> <span class="st">"A_SAXI"</span>, </span>
<span>  <span class="st">"Alpheus_simus"</span> <span class="op">=</span> <span class="st">"A_SIMU"</span>, </span>
<span>  <span class="st">"Alpheus_thomasi"</span> <span class="op">=</span> <span class="st">"A_THOM"</span>, </span>
<span>  <span class="st">"Alpheus_umbo"</span> <span class="op">=</span> <span class="st">"A_UMBO"</span>, </span>
<span>  <span class="st">"Alpheus_utriensis"</span> <span class="op">=</span> <span class="st">"A_UTRI"</span>, </span>
<span>  <span class="st">"Alpheus_verrilli"</span> <span class="op">=</span> <span class="st">"A_VERR"</span>, </span>
<span>  <span class="st">"Alpheus_websteri"</span> <span class="op">=</span> <span class="st">"A_WEBS"</span>, </span>
<span>  <span class="st">"Environmental"</span> <span class="op">=</span> <span class="st">"E_SAMP"</span>, </span>
<span>  <span class="st">"Unknown"</span> <span class="op">=</span> <span class="st">"UNKN"</span></span>
<span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>With these shortcodes in hand we can match each original sample names (from the fastq file names) to the shortcodes.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tmp_shortcode</span> <span class="op">&lt;-</span> <span class="va">tmp_meta</span></span>
<span><span class="va">tmp_shortcode</span> <span class="op">&lt;-</span> <span class="va">tmp_shortcode</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">8</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tmp_shortcode</span> <span class="op">&lt;-</span> <span class="va">tmp_shortcode</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    Ocean_code   <span class="op">=</span> <span class="va">Ocean</span>,</span>
<span>    Species_code <span class="op">=</span> <span class="va">Morphospecies</span>,</span>
<span>    Tissue_code  <span class="op">=</span> <span class="va">Tissue</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">tmp_shortcode</span> <span class="op">&lt;-</span> <span class="va">tmp_shortcode</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    Ocean_code   <span class="op">=</span> <span class="fu">str_replace_all</span><span class="op">(</span><span class="va">Ocean</span>, <span class="va">tmp_ocean</span><span class="op">)</span>,</span>
<span>    Species_code <span class="op">=</span> <span class="fu">str_replace_all</span><span class="op">(</span><span class="va">Morphospecies</span>, <span class="va">tmp_species</span><span class="op">)</span>,</span>
<span>    Tissue_code  <span class="op">=</span> <span class="fu">str_replace_all</span><span class="op">(</span><span class="va">Tissue</span>, <span class="va">tmp_tissue</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">tmp_shortcode</span><span class="op">$</span><span class="va">Ocean_code</span> <span class="op">&lt;-</span> <span class="va">tmp_shortcode</span><span class="op">$</span><span class="va">Ocean</span></span>
<span><span class="va">tmp_shortcode</span> <span class="op">&lt;-</span> <span class="va">tmp_shortcode</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>Ocean_code <span class="op">=</span> <span class="fu">str_replace_all</span><span class="op">(</span><span class="va">Ocean_code</span>, <span class="va">tmp_ocean</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">tmp_shortcode</span><span class="op">$</span><span class="va">Species_code</span> <span class="op">&lt;-</span> <span class="va">tmp_shortcode</span><span class="op">$</span><span class="va">Morphospecies</span></span>
<span><span class="va">tmp_shortcode</span> <span class="op">&lt;-</span> <span class="va">tmp_shortcode</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>Species_code <span class="op">=</span> <span class="fu">str_replace_all</span><span class="op">(</span><span class="va">Species_code</span>, <span class="va">tmp_species</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">tmp_shortcode</span><span class="op">$</span><span class="va">Tissue_code</span> <span class="op">&lt;-</span> <span class="va">tmp_shortcode</span><span class="op">$</span><span class="va">Tissue</span></span>
<span><span class="va">tmp_shortcode</span> <span class="op">&lt;-</span> <span class="va">tmp_shortcode</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>Tissue_code <span class="op">=</span> <span class="fu">str_replace_all</span><span class="op">(</span><span class="va">Tissue_code</span>, <span class="va">tmp_tissue</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">tmp_shortcode</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span></span>
<span><span class="va">tmp_shortcode</span> <span class="op">&lt;-</span> <span class="va">tmp_shortcode</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="st">"Taxon"</span>, .after <span class="op">=</span> <span class="st">"Tissue_code"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
---------------------------------------------------------------------------
 Original_name   Ocean_code   Species_code   Tissue_code        Taxon      
--------------- ------------ -------------- ------------- -----------------
    7322-M           EP          A_PANA          MG        Snapping_shrimp 

    7322-H           EP          A_PANA          HP        Snapping_shrimp 

    7322-S           EP          A_PANA          ST        Snapping_shrimp 

    7322-G           EP          A_PANA          GL        Snapping_shrimp 

    7326-M           EP          A_PANA          MG        Snapping_shrimp 

    7326-G           EP          A_PANA          GL        Snapping_shrimp 
---------------------------------------------------------------------------</code></pre>
</div>
</div>
<p>Still with me? Even though we have the pieces in place to standardize the sample names, we cannot do that yet because different sample types have different initial naming conventions. For examples, Control samples are named like <code>Control-1</code>, <code>Control-2</code>, etc., while the snapping shrimp are named like <code>7322-M</code>, <code>7322-H</code>, etc. Environmental samples have totally different names, for example <code>Machete_scrap2</code>, <code>ML2670</code>, etc. This makes it a litle difficult to parse out meaningful information (specifically ID numbers) from the original sample names and apply our short codes to generate the new names.</p>
<p>When we generated the short codes above we also included a column called <code>Taxon</code>. These data tell us whether a the entry is a snapping shrimp, a control, or an environmental sample.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">tmp_shortcode</span><span class="op">$</span><span class="va">Taxon</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<pre><code>[1] "Snapping_shrimp" "Control"  "Environmental"  </code></pre>
<p>We can use the base R command <code>split</code> to separate the dataset based on the <code>Taxon</code> type so that we can process each category separately.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tmp_split_dfs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html">split</a></span><span class="op">(</span><span class="va">tmp_shortcode</span>, <span class="va">tmp_shortcode</span><span class="op">$</span><span class="va">Taxon</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Generating three separate data frames.</p>
<pre><code>tmp_split_dfs$Control

tmp_split_dfs$Environmental

tmp_split_dfs$Snapping_shrimp</code></pre>
<section id="control-samples" class="level3"><h3 class="anchored" data-anchor-id="control-samples">Control samples</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tmp_control</span> <span class="op">&lt;-</span> <span class="va">tmp_split_dfs</span><span class="op">$</span><span class="va">Control</span></span>
<span><span class="va">tmp_control</span><span class="op">$</span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="va">tmp_control</span><span class="op">$</span><span class="va">Original_name</span></span>
<span></span>
<span><span class="va">tmp_control</span> <span class="op">&lt;-</span> <span class="va">tmp_control</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">separate_wider_delim</span><span class="op">(</span><span class="va">tmp</span>, delim <span class="op">=</span> <span class="st">"-"</span>, names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"tmp1"</span>, <span class="st">"ID"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tmp_control</span><span class="op">$</span><span class="va">tmp1</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section><section id="environmental-samples" class="level3"><h3 class="anchored" data-anchor-id="environmental-samples">Environmental samples</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tmp_envr</span> <span class="op">&lt;-</span> <span class="va">tmp_split_dfs</span><span class="op">$</span><span class="va">Environmental</span></span>
<span><span class="va">tmp_envr</span><span class="op">$</span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="va">tmp_envr</span><span class="op">$</span><span class="va">Original_name</span></span>
<span></span>
<span><span class="va">tmp_envr</span> <span class="op">&lt;-</span> <span class="va">tmp_envr</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">separate_wider_delim</span><span class="op">(</span><span class="va">tmp</span>,</span>
<span>                       delim <span class="op">=</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/modifiers.html">regex</a></span><span class="op">(</span><span class="st">"(_)|(ML)"</span><span class="op">)</span>,</span>
<span>                       too_few <span class="op">=</span> <span class="st">"align_start"</span>,</span>
<span>                       names_sep <span class="op">=</span> <span class="st">""</span>,</span>
<span>                       names_repair <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">sub</a></span><span class="op">(</span><span class="st">"value"</span>, <span class="st">"X"</span>, <span class="va">.x</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tmp_envr</span><span class="op">$</span><span class="va">tmp2</span> <span class="op">&lt;-</span> <span class="fu">str_replace</span><span class="op">(</span><span class="va">tmp_envr</span><span class="op">$</span><span class="va">tmp2</span>, <span class="st">"(\\d+).*"</span>, <span class="st">"\\1"</span><span class="op">)</span></span>
<span><span class="va">tmp_envr</span><span class="op">$</span><span class="va">tmp2</span> <span class="op">&lt;-</span> <span class="fu">str_replace</span><span class="op">(</span><span class="va">tmp_envr</span><span class="op">$</span><span class="va">tmp2</span>, <span class="st">"Sed"</span>, <span class="st">"sed"</span><span class="op">)</span></span>
<span><span class="va">tmp_envr</span><span class="op">$</span><span class="va">tmp1</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">tmp_envr</span> <span class="op">&lt;-</span> <span class="va">tmp_envr</span> <span class="op">%&gt;%</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>ID <span class="op">=</span> <span class="va">tmp2</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section><section id="shrimp-samples" class="level3"><h3 class="anchored" data-anchor-id="shrimp-samples">Shrimp samples</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tmp_shrmp</span> <span class="op">&lt;-</span> <span class="va">tmp_split_dfs</span><span class="op">$</span><span class="va">Snapping_shrimp</span></span>
<span></span>
<span><span class="va">tmp_shrmp</span><span class="op">$</span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="va">tmp_shrmp</span><span class="op">$</span><span class="va">Original_name</span></span>
<span><span class="va">tmp_shrmp</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Original_name</span> <span class="op">==</span> <span class="st">"7332-H-M"</span><span class="op">)</span></span>
<span><span class="va">tmp_shrmp</span><span class="op">$</span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"7332-H-M"</span>, <span class="st">"7332M-H"</span>, <span class="va">tmp_shrmp</span><span class="op">$</span><span class="va">tmp</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tmp_shrmp</span> <span class="op">&lt;-</span> <span class="va">tmp_shrmp</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">separate_wider_delim</span><span class="op">(</span><span class="va">tmp</span>,</span>
<span>                       delim <span class="op">=</span> <span class="st">"-"</span>,</span>
<span>                       names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"tmp1"</span>, <span class="st">"tmp2"</span><span class="op">)</span></span>
<span>                       <span class="op">)</span></span>
<span><span class="va">tmp_shrmp</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Original_name</span> <span class="op">==</span> <span class="st">"7332-H-M"</span><span class="op">)</span></span>
<span><span class="va">tmp_shrmp</span><span class="op">$</span><span class="va">tmp2</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">tmp_shrmp</span> <span class="op">&lt;-</span> <span class="va">tmp_shrmp</span> <span class="op">%&gt;%</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>ID <span class="op">=</span> <span class="va">tmp1</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Sweet. At this point we can generate the new unique name for each sample based on the criteria listed above.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tmp_control</span><span class="op">$</span><span class="va">SampleID</span> <span class="op">&lt;-</span> <span class="va">tmp_control</span><span class="op">$</span><span class="va">Original_name</span></span>
<span><span class="va">tmp_control</span><span class="op">$</span><span class="va">SampleID</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"-"</span>, <span class="st">"_"</span>, <span class="va">tmp_control</span><span class="op">$</span><span class="va">SampleID</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tmp_envr</span> <span class="op">&lt;-</span> <span class="va">tmp_envr</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>SampleID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">Ocean_code</span>, </span>
<span>                          <span class="va">Species_code</span>, </span>
<span>                          <span class="va">Tissue_code</span>, </span>
<span>                          <span class="va">ID</span>, </span>
<span>                          sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tmp_shrmp</span> <span class="op">&lt;-</span> <span class="va">tmp_shrmp</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>SampleID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">Ocean_code</span>, </span>
<span>                          <span class="va">Species_code</span>, </span>
<span>                          <span class="va">Tissue_code</span>, </span>
<span>                          <span class="va">ID</span>, </span>
<span>                          sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>And combine the three modified data frames.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tmp_combo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">tmp_control</span>, <span class="va">tmp_envr</span>, <span class="va">tmp_shrmp</span><span class="op">)</span></span>
<span><span class="va">tmp_combo</span><span class="op">$</span><span class="va">Taxon</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">shortcodes</span> <span class="op">&lt;-</span> <span class="va">tmp_combo</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>And generate a modified metadata file containing the new sample ID plus the original and modified fastq file names. We have a four column tab delimited text file called <code>fastq_info.txt</code> that contains the original sample names, the run ID, plus the original forward and reverse fastq file names.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tmp_combo</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">tmp_fastq</span> <span class="op">&lt;-</span> <span class="fu">read_delim</span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="va">work_here</span>, <span class="st">"fastq_info.txt"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">all_metadata</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">tmp_meta</span>, <span class="va">tmp_combo</span>, by <span class="op">=</span> <span class="st">"Original_name"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">.</span>, <span class="va">tmp_fastq</span>, by <span class="op">=</span> <span class="st">"Original_name"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">all_metadata</span> <span class="op">&lt;-</span> <span class="va">all_metadata</span> <span class="op">%&gt;%</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="st">"SampleID"</span>, </span>
<span>                                         .before <span class="op">=</span> <span class="st">"Original_name"</span><span class="op">)</span></span>
<span><span class="va">all_metadata</span> <span class="op">&lt;-</span> <span class="va">all_metadata</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="st">"Run"</span>, .before <span class="op">=</span> <span class="st">"Plate"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">all_metadata</span> <span class="op">&lt;-</span> <span class="va">all_metadata</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>Fastq_ID_forward_rename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">SampleID</span>, <span class="st">"_R1.fastq.gz"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">relocate</span><span class="op">(</span><span class="va">Fastq_ID_forward_rename</span>, .after <span class="op">=</span> <span class="va">Fastq_ID_forward_original</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>Fastq_ID_reverse_rename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">SampleID</span>, <span class="st">"_R2.fastq.gz"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">relocate</span><span class="op">(</span><span class="va">Fastq_ID_reverse_rename</span>, .after <span class="op">=</span> <span class="va">Fastq_ID_reverse_original</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section></section><section id="modified-metadata" class="level2"><h2 class="anchored" data-anchor-id="modified-metadata">Modified Metadata</h2>
<p>And here is the modified metadata.</p>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Expand to column descriptions for sample table
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<table class="caption-top table">
<colgroup>
<col style="width: 38%">
<col style="width: 61%">
</colgroup>
<thead><tr class="header">
<th>Header</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>SampleID</code></td>
<td>Sample ID based on Ocean, species, tissue, &amp; unique ID</td>
</tr>
<tr class="even">
<td><code>Original_name</code></td>
<td>Original sample ID</td>
</tr>
<tr class="odd">
<td><code>Ocean</code></td>
<td>Sampling ocean</td>
</tr>
<tr class="even">
<td><code>Morphospecies</code></td>
<td>Host shrimp species</td>
</tr>
<tr class="odd">
<td><code>Tissue</code></td>
<td>Shrimp tissue type</td>
</tr>
<tr class="even">
<td><code>Habitat</code></td>
<td>Sampling habitat</td>
</tr>
<tr class="odd">
<td><code>Site</code></td>
<td>Sampling Site 1</td>
</tr>
<tr class="even">
<td><code>Site_2</code></td>
<td>Sampling Site 2</td>
</tr>
<tr class="odd">
<td><code>Taxon</code></td>
<td>Shrimp, environmental samples, or Controls</td>
</tr>
<tr class="even">
<td><code>Length</code></td>
<td>Length of individual</td>
</tr>
<tr class="odd">
<td><code>Station_no</code></td>
<td>ASK MATT</td>
</tr>
<tr class="even">
<td><code>Species_pair</code></td>
<td>ASK MATT</td>
</tr>
<tr class="odd">
<td><code>Species_group</code></td>
<td>ASK MATT</td>
</tr>
<tr class="even">
<td><code>Species_complex</code></td>
<td>ASK MATT</td>
</tr>
<tr class="odd">
<td><code>Run</code></td>
<td>Sequencing run ID</td>
</tr>
<tr class="even">
<td><code>Plate</code></td>
<td>Sequencing plate ID</td>
</tr>
<tr class="odd">
<td><code>Row</code></td>
<td>Sequencing plate row number</td>
</tr>
<tr class="even">
<td><code>Column</code></td>
<td>Sequencing plate column number</td>
</tr>
<tr class="odd">
<td><code>Fastq_ID_forward_original</code></td>
<td>Original fastq ID (F)</td>
</tr>
<tr class="even">
<td><code>Fastq_ID_forward_rename</code></td>
<td>New fastq ID (F)</td>
</tr>
<tr class="odd">
<td><code>Fastq_ID_reverse_original</code></td>
<td>Original fastq ID (R)</td>
</tr>
<tr class="even">
<td><code>Fastq_ID_reverse_rename</code></td>
<td>New fastq ID (R)</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>We sequenced a total of 1909 samples, including 1797 shrimp samples, 52 environmental samples, and 60 control samples. 884 total samples came from the Eastern Pacific and 965 from the Western Atlantic.</p>
</section><section id="rename-fastq-files" class="level2"><h2 class="anchored" data-anchor-id="rename-fastq-files">Rename FastQ Files</h2>
<p>Using the modified metadata, specifically the new sample names, we can rename all fastq file prior to processing the data. To batch rename samples we created tab-delimited <em>lookup tables</em>, where the first column contains the original name of each fastq file while the second column corresponds to the new name. We did this for each sequencing run. Here is an example of the first few samples from the lookup table for run BCS_34, which we call <code>BCS_34.rename.txt</code></p>
<pre><code>8937-G_R1_001.trimmed.fastq EP_A_HEBE_GL_8937_R1_001.trimmed.fastq
8937-H_R1_001.trimmed.fastq EP_A_HEBE_HP_8937_R1_001.trimmed.fastq
8937-M_R1_001.trimmed.fastq EP_A_HEBE_MG_8937_R1_001.trimmed.fastq
8937-S_R1_001.trimmed.fastq EP_A_HEBE_ST_8937_R1_001.trimmed.fastq</code></pre>
<p>We use the new metadata file and the base R command <code>split</code> to generate initial lookup tables for each of the six sequencing runs.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tmp_split_dfs</span> <span class="op">&lt;-</span> <span class="va">all_metadata</span></span>
<span><span class="va">tmp_split_dfs</span> <span class="op">&lt;-</span> <span class="va">tmp_split_dfs</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Run</span>, </span>
<span>                <span class="va">Fastq_ID_forward_original</span>, </span>
<span>                <span class="va">Fastq_ID_forward_rename</span>, </span>
<span>                <span class="va">Fastq_ID_reverse_original</span>, </span>
<span>                <span class="va">Fastq_ID_reverse_rename</span><span class="op">)</span></span>
<span><span class="va">split_dfs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html">split</a></span><span class="op">(</span><span class="va">tmp_split_dfs</span>, <span class="va">tmp_split_dfs</span><span class="op">$</span><span class="va">Run</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Again, a partial example from run BCS_34.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
-------------------------------------------------------------------------
  Run       Fastq_ID_forward_original         Fastq_ID_forward_rename    
-------- -------------------------------- -------------------------------
 BCS_34   9123-G_R1_001.trimmed.fastq.gz   EP_A_ROST_GL_9123_R1.fastq.gz 

 BCS_34   9123-H_R1_001.trimmed.fastq.gz   EP_A_ROST_HP_9123_R1.fastq.gz 

 BCS_34   9123-M_R1_001.trimmed.fastq.gz   EP_A_ROST_MG_9123_R1.fastq.gz 
-------------------------------------------------------------------------</code></pre>
</div>
</div>
<p>Finally, a little wrangling and then save each lookup table.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">split_dfs</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">tmp_ds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span></span>
<span>  <span class="va">tmp_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">i</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">tmp_runF</span> <span class="op">&lt;-</span> <span class="va">tmp_ds</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Run</span>, </span>
<span>                  <span class="va">Fastq_ID_forward_original</span>, </span>
<span>                  <span class="va">Fastq_ID_forward_rename</span><span class="op">)</span></span>
<span>  <span class="va">tmp_runF</span><span class="op">$</span><span class="va">Run</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>  <span class="va">tmp_runF</span> <span class="op">&lt;-</span> <span class="va">tmp_runF</span> <span class="op">%&gt;%</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span><span class="st">"X1"</span> <span class="op">=</span> <span class="fl">1</span>, <span class="st">"X2"</span> <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">tmp_runR</span> <span class="op">&lt;-</span> <span class="va">tmp_ds</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Run</span>,</span>
<span>                  <span class="va">Fastq_ID_reverse_original</span>, </span>
<span>                  <span class="va">Fastq_ID_reverse_rename</span><span class="op">)</span></span>
<span>  <span class="va">tmp_runR</span><span class="op">$</span><span class="va">Run</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>  <span class="va">tmp_runR</span> <span class="op">&lt;-</span> <span class="va">tmp_runR</span> <span class="op">%&gt;%</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span><span class="st">"X1"</span> <span class="op">=</span> <span class="fl">1</span>, <span class="st">"X2"</span> <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">tmp_run</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">tmp_runF</span>, <span class="va">tmp_runR</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/assign.html">assign</a></span><span class="op">(</span><span class="va">tmp_name</span>, <span class="va">tmp_run</span><span class="op">)</span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.table</a></span><span class="op">(</span></span>
<span>    <span class="va">tmp_run</span>, </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="va">share_here</span>, <span class="st">"fastq_rename_lookup"</span>, <span class="va">tmp_name</span><span class="op">)</span>, </span>
<span>          <span class="st">".rename.txt"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>, </span>
<span>    sep <span class="op">=</span> <span class="st">"\t"</span>, </span>
<span>    quote <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>    row.names <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>    col.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"tmp_"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Once we have lookup tables, we can run the bash script called <code>rename.sh</code>. This code will take the lookup table and go through each <code>fastq</code> file in the run directory and assign the new name. It will also output a timestamped rename results file showing the name changes. The script is run like so:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> rename.sh /path/to/files/ rename_file.txt <span class="pp">[--</span><span class="ss">dry</span><span class="pp">-</span><span class="ss">run</span><span class="pp">]</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Pass the script a path to the fatsq files and a lookup table. If you just want to see what changes will be made without actually making the changes you can include the flag <code>--dry-run</code>. Here is an example from this dataset:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> rename.sh 01_TRIMMED_DATA/BCS_34_Istmo_S1-2_trimmed/ BCS_34.rename.txt</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>And you should see something like this in the results file:</p>
<pre><code>8937-G_R1_001.trimmed.fastq.gz -&gt; EP_A_HEBE_GL_8937_R1.fastq.gz
8937-H_R1_001.trimmed.fastq.gz -&gt; EP_A_HEBE_HP_8937_R1.fastq.gz
8937-M_R1_001.trimmed.fastq.gz -&gt; EP_A_HEBE_MG_8937_R1.fastq.gz
8937-S_R1_001.trimmed.fastq.gz -&gt; EP_A_HEBE_ST_8937_R1.fastq.gz
8938-G_R1_001.trimmed.fastq.gz -&gt; EP_A_HEBE_GL_8938_R1.fastq.gz
8938-H_R1_001.trimmed.fastq.gz -&gt; EP_A_HEBE_HP_8938_R1.fastq.gz</code></pre>
</section><section id="save-sample-data" class="level2"><h2 class="anchored" data-anchor-id="save-sample-data">Save Sample Data</h2>
<p>The last thing to do is define a sample data frame that contains only the most relevant metadata. This table will be used in all downstream analyses to define samples.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tmp_shortcodes</span> <span class="op">&lt;-</span> <span class="va">shortcodes</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">shortcodes</span><span class="op">$</span><span class="va">SampleID</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">tmp_metadata</span> <span class="op">&lt;-</span> <span class="va">all_metadata</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">all_metadata</span><span class="op">$</span><span class="va">SampleID</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/identical.html">identical</a></span><span class="op">(</span><span class="va">tmp_shortcodes</span><span class="op">$</span><span class="va">SampleID</span>, <span class="va">tmp_metadata</span><span class="op">$</span><span class="va">SampleID</span><span class="op">)</span></span>
<span></span>
<span><span class="va">samptab</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">tmp_metadata</span>, <span class="va">tmp_shortcodes</span>, </span>
<span>                            by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"SampleID"</span>, <span class="st">"Original_name"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sample_df</span> <span class="op">&lt;-</span> <span class="va">samptab</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span></span>
<span>    SampleID <span class="op">=</span> <span class="va">SampleID</span>,</span>
<span>    OCEAN    <span class="op">=</span> <span class="va">Ocean_code</span>,</span>
<span>    SPECIES  <span class="op">=</span> <span class="va">Species_code</span>,</span>
<span>    TISSUE   <span class="op">=</span> <span class="va">Tissue_code</span>,</span>
<span>    ID       <span class="op">=</span> <span class="va">ID</span>,</span>
<span>    SITE     <span class="op">=</span> <span class="va">Site</span>,</span>
<span>    SITE2    <span class="op">=</span> <span class="va">Site_2</span>,</span>
<span>    HABITAT  <span class="op">=</span> <span class="va">Habitat</span>,</span>
<span>    TAXON    <span class="op">=</span> <span class="va">Taxon</span>,</span>
<span>    PAIR     <span class="op">=</span> <span class="va">Species_pair</span>,</span>
<span>    GROUP    <span class="op">=</span> <span class="va">Species_group</span>,</span>
<span>    COMPLEX  <span class="op">=</span> <span class="va">Species_complex</span>,</span>
<span>    RUN      <span class="op">=</span> <span class="va">Run</span>,</span>
<span>    PLATE    <span class="op">=</span> <span class="va">Plate</span></span>
<span>  <span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Moving on.</p>
<!------------------------------------------------------------------------>
<!-------------------- Use this area to save things ---------------------->
<!------------------------------------------------------------------------>
<!--------------------------------------->
<!-- These chunks are for curated data -->
<!--------------------------------------->
<!-------------------------------------------->
<!-- These chunks are for  processing data  -->
<!-------------------------------------------->
</section><div id="quarto-appendix" class="default"><section id="detailed-session-info" class="level4 appendix"><h2 class="anchored quarto-appendix-heading">Detailed Session Info</h2><div class="quarto-appendix-contents">
<details><summary>Expand to see Session Info</summary><div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>─ Session info ───────────────────────────────────────────────────────────────
 setting  value
 version  R version 4.5.1 (2025-06-13)
 os       macOS Ventura 13.7.8
 system   x86_64, darwin20
 ui       X11
 language (EN)
 collate  en_US.UTF-8
 ctype    en_US.UTF-8
 tz       America/Los_Angeles
 date     2025-10-02
 pandoc   3.6.3 @ /Applications/RStudio.app/Contents/Resources/app/quarto/bin/tools/x86_64/ (via rmarkdown)
 quarto   1.8.25 @ /Applications/quarto/bin/quarto

─ Packages ───────────────────────────────────────────────────────────────────
 package                  * version   date (UTC) lib source
 Biobase                  * 2.68.0    2025-04-15 [1] Bioconductor 3.21 (R 4.5.0)
 BiocGenerics             * 0.54.0    2025-04-15 [1] Bioconductor 3.21 (R 4.5.0)
 Biostrings               * 2.76.0    2025-04-15 [1] Bioconductor 3.21 (R 4.5.0)
 downloadthis             * 0.5.0     2025-09-26 [1] Github (fmmattioni/downloadthis@18e3e5a)
 dplyr                    * 1.1.4     2023-11-17 [1] CRAN (R 4.5.0)
 fontawesome              * 0.5.3     2024-11-16 [1] CRAN (R 4.5.0)
 forcats                  * 1.0.0     2023-01-29 [1] CRAN (R 4.5.0)
 fs                       * 1.6.6     2025-04-12 [1] CRAN (R 4.5.0)
 generics                 * 0.1.4     2025-05-09 [1] CRAN (R 4.5.0)
 GenomeInfoDb             * 1.44.2    2025-08-18 [1] Bioconductor 3.21 (R 4.5.1)
 GenomicRanges            * 1.60.0    2025-04-15 [1] Bioconductor 3.21 (R 4.5.0)
 ggplot2                  * 4.0.0     2025-09-11 [1] CRAN (R 4.5.1)
 here                     * 1.0.2     2025-09-15 [1] CRAN (R 4.5.1)
 htmltools                * 0.5.8.1   2024-04-04 [1] CRAN (R 4.5.0)
 IRanges                  * 2.42.0    2025-04-15 [1] Bioconductor 3.21 (R 4.5.0)
 lubridate                * 1.9.4     2024-12-08 [1] CRAN (R 4.5.0)
 magrittr                 * 2.0.4     2025-09-12 [1] CRAN (R 4.5.1)
 MatrixGenerics           * 1.20.0    2025-04-15 [1] Bioconductor 3.21 (R 4.5.0)
 matrixStats              * 1.5.0     2025-01-07 [1] CRAN (R 4.5.0)
 mia                      * 1.15.6    2024-11-22 [1] Bioconductor 3.21 (R 4.5.0)
 microbiome               * 1.30.0    2025-04-15 [1] Bioconductor 3.21 (R 4.5.0)
 microeco                 * 1.15.0    2025-05-18 [1] CRAN (R 4.5.0)
 microViz                 * 0.12.7    2025-08-01 [1] https://david-barnett.r-universe.dev (R 4.5.1)
 MultiAssayExperiment     * 1.34.0    2025-04-15 [1] Bioconductor 3.21 (R 4.5.0)
 pander                   * 0.6.6     2025-03-01 [1] CRAN (R 4.5.0)
 phyloseq                 * 1.52.0    2025-04-15 [1] Bioconductor 3.21 (R 4.5.0)
 purrr                    * 1.1.0     2025-07-10 [1] CRAN (R 4.5.1)
 R.methodsS3              * 1.8.2     2022-06-13 [1] CRAN (R 4.5.0)
 R.oo                     * 1.27.1    2025-05-02 [1] CRAN (R 4.5.0)
 R.utils                  * 2.13.0    2025-02-24 [1] CRAN (R 4.5.0)
 reactable                * 0.4.4     2023-03-12 [1] CRAN (R 4.5.0)
 reactablefmtr            * 2.0.0     2022-03-16 [1] CRAN (R 4.5.0)
 readr                    * 2.1.5     2024-01-10 [1] CRAN (R 4.5.0)
 S4Vectors                * 0.46.0    2025-04-15 [1] Bioconductor 3.21 (R 4.5.0)
 seqinr                   * 4.2-36    2023-12-08 [1] CRAN (R 4.5.0)
 sessioninfo              * 1.2.3     2025-02-05 [1] CRAN (R 4.5.0)
 SingleCellExperiment     * 1.30.1    2025-05-05 [1] Bioconductor 3.21 (R 4.5.0)
 stringr                  * 1.5.2     2025-09-08 [1] CRAN (R 4.5.1)
 SummarizedExperiment     * 1.38.1    2025-04-28 [1] Bioconductor 3.21 (R 4.5.0)
 tibble                   * 3.3.0     2025-06-08 [1] CRAN (R 4.5.0)
 tidyr                    * 1.3.1     2024-01-24 [1] CRAN (R 4.5.0)
 tidyverse                * 2.0.0     2023-02-22 [1] CRAN (R 4.5.0)
 tinytable                * 0.13.0.10 2025-09-07 [1] https://vincentarelbundock.r-universe.dev (R 4.5.1)
 TreeSummarizedExperiment * 2.16.1    2025-05-08 [1] Bioconductor 3.21 (R 4.5.0)
 XVector                  * 0.48.0    2025-04-15 [1] Bioconductor 3.21 (R 4.5.0)
 zip                      * 2.3.3     2025-05-13 [1] CRAN (R 4.5.0)

 [1] /Library/Frameworks/R.framework/Versions/4.5-x86_64/Resources/library
 * ── Packages attached to the search path.

──────────────────────────────────────────────────────────────────────────────</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
======   Devtools Session info   ===================================</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> package                  * version   date (UTC) lib source
 Biobase                  * 2.68.0    2025-04-15 [1] Bioconductor 3.21 (R 4.5.0)
 BiocGenerics             * 0.54.0    2025-04-15 [1] Bioconductor 3.21 (R 4.5.0)
 Biostrings               * 2.76.0    2025-04-15 [1] Bioconductor 3.21 (R 4.5.0)
 downloadthis             * 0.5.0     2025-09-26 [1] Github (fmmattioni/downloadthis@18e3e5a)
 dplyr                    * 1.1.4     2023-11-17 [1] CRAN (R 4.5.0)
 fontawesome              * 0.5.3     2024-11-16 [1] CRAN (R 4.5.0)
 forcats                  * 1.0.0     2023-01-29 [1] CRAN (R 4.5.0)
 fs                       * 1.6.6     2025-04-12 [1] CRAN (R 4.5.0)
 generics                 * 0.1.4     2025-05-09 [1] CRAN (R 4.5.0)
 GenomeInfoDb             * 1.44.2    2025-08-18 [1] Bioconductor 3.21 (R 4.5.1)
 GenomicRanges            * 1.60.0    2025-04-15 [1] Bioconductor 3.21 (R 4.5.0)
 ggplot2                  * 4.0.0     2025-09-11 [1] CRAN (R 4.5.1)
 here                     * 1.0.2     2025-09-15 [1] CRAN (R 4.5.1)
 htmltools                * 0.5.8.1   2024-04-04 [1] CRAN (R 4.5.0)
 IRanges                  * 2.42.0    2025-04-15 [1] Bioconductor 3.21 (R 4.5.0)
 lubridate                * 1.9.4     2024-12-08 [1] CRAN (R 4.5.0)
 magrittr                 * 2.0.4     2025-09-12 [1] CRAN (R 4.5.1)
 MatrixGenerics           * 1.20.0    2025-04-15 [1] Bioconductor 3.21 (R 4.5.0)
 matrixStats              * 1.5.0     2025-01-07 [1] CRAN (R 4.5.0)
 mia                      * 1.15.6    2024-11-22 [1] Bioconductor 3.21 (R 4.5.0)
 microbiome               * 1.30.0    2025-04-15 [1] Bioconductor 3.21 (R 4.5.0)
 microeco                 * 1.15.0    2025-05-18 [1] CRAN (R 4.5.0)
 microViz                 * 0.12.7    2025-08-01 [1] https://david-barnett.r-universe.dev (R 4.5.1)
 MultiAssayExperiment     * 1.34.0    2025-04-15 [1] Bioconductor 3.21 (R 4.5.0)
 pander                   * 0.6.6     2025-03-01 [1] CRAN (R 4.5.0)
 phyloseq                 * 1.52.0    2025-04-15 [1] Bioconductor 3.21 (R 4.5.0)
 purrr                    * 1.1.0     2025-07-10 [1] CRAN (R 4.5.1)
 R.methodsS3              * 1.8.2     2022-06-13 [1] CRAN (R 4.5.0)
 R.oo                     * 1.27.1    2025-05-02 [1] CRAN (R 4.5.0)
 R.utils                  * 2.13.0    2025-02-24 [1] CRAN (R 4.5.0)
 reactable                * 0.4.4     2023-03-12 [1] CRAN (R 4.5.0)
 reactablefmtr            * 2.0.0     2022-03-16 [1] CRAN (R 4.5.0)
 readr                    * 2.1.5     2024-01-10 [1] CRAN (R 4.5.0)
 S4Vectors                * 0.46.0    2025-04-15 [1] Bioconductor 3.21 (R 4.5.0)
 seqinr                   * 4.2-36    2023-12-08 [1] CRAN (R 4.5.0)
 sessioninfo              * 1.2.3     2025-02-05 [1] CRAN (R 4.5.0)
 SingleCellExperiment     * 1.30.1    2025-05-05 [1] Bioconductor 3.21 (R 4.5.0)
 stringr                  * 1.5.2     2025-09-08 [1] CRAN (R 4.5.1)
 SummarizedExperiment     * 1.38.1    2025-04-28 [1] Bioconductor 3.21 (R 4.5.0)
 tibble                   * 3.3.0     2025-06-08 [1] CRAN (R 4.5.0)
 tidyr                    * 1.3.1     2024-01-24 [1] CRAN (R 4.5.0)
 tidyverse                * 2.0.0     2023-02-22 [1] CRAN (R 4.5.0)
 tinytable                * 0.13.0.10 2025-09-07 [1] https://vincentarelbundock.r-universe.dev (R 4.5.1)
 TreeSummarizedExperiment * 2.16.1    2025-05-08 [1] Bioconductor 3.21 (R 4.5.0)
 XVector                  * 0.48.0    2025-04-15 [1] Bioconductor 3.21 (R 4.5.0)
 zip                      * 2.3.3     2025-05-13 [1] CRAN (R 4.5.0)

 [1] /Library/Frameworks/R.framework/Versions/4.5-x86_64/Resources/library
 * ── Packages attached to the search path.</code></pre>
</div>
</div>
</details></div></section><section id="last-updated-on" class="level4 appendix"><h2 class="anchored quarto-appendix-heading">Last updated on</h2><div class="quarto-appendix-contents">
<p>2025-10-02</p>



<!-- -->

</div></section><section class="level4 appendix"><h2 class="quarto-appendix-heading">Collected Links</h2><div class="quarto-appendix-contents">
<ul>
<li><a href="https://quarto.org/">Quarto</a></li>
<li><a href="https://metacrobe.github.io/">metacrobe</a></li>
<li><a href="https://istmobiome.rbind.io/">The Istmobiome Project</a></li>
</ul></div></section></div></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/istmobiome\.github\.io\/trans-shrimp\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../../../workflows/ssu/index.html" class="pagination-link" aria-label="16S rRNA">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">16S rRNA</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../../workflows/ssu/dada2/index.html" class="pagination-link" aria-label="2. DADA2 ASV Workflow">
        <span class="nav-page-text">2. DADA2 ASV Workflow</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb32" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "1. Sample Metadata"</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> |</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co">  Workflow for wrangling sample metadata and generating informative sample names.</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="an">listing:</span><span class="co"> </span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="co">    id: sd-listing</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="co">    contents: data-sd.yml</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="co">    type: table</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="co">    sort-ui: false</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="co">    filter-ui: false</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="co">    fields: </span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="co">      - filename</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="co">      - description</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a><span class="co">    field-links: </span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a><span class="co">      - filename</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a><span class="co">    field-display-names: </span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a><span class="co">      filename: File Name</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a><span class="co">      description: Description</span></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>{{&lt; include /include/_setup.qmd &gt;}}</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false </span></span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hide</span></span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: set wd for here</span></span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a><span class="fu">remove</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">here</span>(<span class="st">"page_build"</span>, <span class="st">"ssu_sampledata.rdata"</span>))</span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a>workflow_name <span class="ot">&lt;-</span> <span class="st">"sampledata"</span> <span class="co"># e.g., med, dada2, etc</span></span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a>work_here <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"working_files/ssu/"</span>, workflow_name)</span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a>share_here <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"share/ssu/"</span>, workflow_name)</span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a><span class="fu">## Workflow Input</span></span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a>::: {.callout-note icon=false}</span>
<span id="cb32-41"><a href="#cb32-41" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data &amp; Scripts</span></span>
<span id="cb32-42"><a href="#cb32-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-43"><a href="#cb32-43" aria-hidden="true" tabindex="-1"></a>The table below contains links to files and scripts needed to run this workflow--specifically the <span class="in">`sampledata_processing.zip`</span> archive which contains the necessary assets. Also included are the sample data tables generated at the end of the pipeline.</span>
<span id="cb32-44"><a href="#cb32-44" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb32-45"><a href="#cb32-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-46"><a href="#cb32-46" aria-hidden="true" tabindex="-1"></a>::: {#sd-listing .column-body}</span>
<span id="cb32-47"><a href="#cb32-47" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb32-48"><a href="#cb32-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-49"><a href="#cb32-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-50"><a href="#cb32-50" aria-hidden="true" tabindex="-1"></a><span class="fu">## Overview</span></span>
<span id="cb32-51"><a href="#cb32-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-52"><a href="#cb32-52" aria-hidden="true" tabindex="-1"></a>This workflow is designed to process our raw metadata files and generate more informative sample names. Our aim is to standardize metadata entries, generate new sample names, and save sample data frames that are used in downstream analyses. </span>
<span id="cb32-53"><a href="#cb32-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-54"><a href="#cb32-54" aria-hidden="true" tabindex="-1"></a><span class="fu">## Curate Metadata</span></span>
<span id="cb32-55"><a href="#cb32-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-56"><a href="#cb32-56" aria-hidden="true" tabindex="-1"></a>The first step in to load all metadata files (one for each sequencing run) and combine the files. </span>
<span id="cb32-57"><a href="#cb32-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-60"><a href="#cb32-60" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-61"><a href="#cb32-61" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb32-62"><a href="#cb32-62" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb32-63"><a href="#cb32-63" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: "for interactive testing"</span></span>
<span id="cb32-64"><a href="#cb32-64" aria-hidden="true" tabindex="-1"></a>project_root <span class="ot">&lt;-</span> quarto<span class="sc">::</span><span class="fu">find_project_root</span>()</span>
<span id="cb32-65"><a href="#cb32-65" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct the full path to your functions script</span></span>
<span id="cb32-66"><a href="#cb32-66" aria-hidden="true" tabindex="-1"></a>sampdata_path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(project_root, <span class="st">"working_files/ssu/sampledata"</span>)</span>
<span id="cb32-67"><a href="#cb32-67" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-68"><a href="#cb32-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-71"><a href="#cb32-71" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-72"><a href="#cb32-72" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb32-73"><a href="#cb32-73" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb32-74"><a href="#cb32-74" aria-hidden="true" tabindex="-1"></a>file_paths <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="at">path =</span> <span class="fu">paste0</span>(<span class="fu">here</span>(work_here, <span class="st">"/metadata_files"</span>)), </span>
<span id="cb32-75"><a href="#cb32-75" aria-hidden="true" tabindex="-1"></a>                         <span class="at">pattern =</span> <span class="st">"</span><span class="sc">\\</span><span class="st">.csv$"</span>, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb32-76"><a href="#cb32-76" aria-hidden="true" tabindex="-1"></a>tmp_meta <span class="ot">&lt;-</span> vroom<span class="sc">::</span><span class="fu">vroom</span>(file_paths)</span>
<span id="cb32-77"><a href="#cb32-77" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tmp_meta)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"Original_name"</span></span>
<span id="cb32-78"><a href="#cb32-78" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-79"><a href="#cb32-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-80"><a href="#cb32-80" aria-hidden="true" tabindex="-1"></a>Next we remove any duplicate entries. We have duplicates because some samples were sequenced more than once due to low read count from the initial run. </span>
<span id="cb32-81"><a href="#cb32-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-84"><a href="#cb32-84" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-85"><a href="#cb32-85" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb32-86"><a href="#cb32-86" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb32-87"><a href="#cb32-87" aria-hidden="true" tabindex="-1"></a>dups_in_md <span class="ot">&lt;-</span> tmp_meta[<span class="fu">duplicated</span>(tmp_meta[,<span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>]),]</span>
<span id="cb32-88"><a href="#cb32-88" aria-hidden="true" tabindex="-1"></a>tmp_meta <span class="ot">&lt;-</span> tmp_meta[<span class="sc">!</span><span class="fu">duplicated</span>(tmp_meta[,<span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>]),]</span>
<span id="cb32-89"><a href="#cb32-89" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-90"><a href="#cb32-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-91"><a href="#cb32-91" aria-hidden="true" tabindex="-1"></a>Next we remove several samples due to low initial read count. We pulled these out before doing any renaming, processing, etc. so they are only listed in the metadata files.</span>
<span id="cb32-92"><a href="#cb32-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-95"><a href="#cb32-95" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-96"><a href="#cb32-96" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb32-97"><a href="#cb32-97" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb32-98"><a href="#cb32-98" aria-hidden="true" tabindex="-1"></a><span class="do">#### Regex Code for partial matches</span></span>
<span id="cb32-99"><a href="#cb32-99" aria-hidden="true" tabindex="-1"></a>tmp_lc_samp <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"7512"</span>, <span class="st">"8978-S"</span>, <span class="st">"8978-H"</span>, <span class="st">"7640-S"</span>)</span>
<span id="cb32-100"><a href="#cb32-100" aria-hidden="true" tabindex="-1"></a>tmp_meta <span class="ot">&lt;-</span> tmp_meta[<span class="sc">!</span><span class="fu">grepl</span>(<span class="fu">paste</span>(tmp_lc_samp, <span class="at">collapse =</span> <span class="st">"|"</span>), </span>
<span id="cb32-101"><a href="#cb32-101" aria-hidden="true" tabindex="-1"></a>                            tmp_meta<span class="sc">$</span>Original_name), ]</span>
<span id="cb32-102"><a href="#cb32-102" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-103"><a href="#cb32-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-104"><a href="#cb32-104" aria-hidden="true" tabindex="-1"></a>And finally do a little maintenance on column names. What we are after here is standardized column names without spaces, periods, dashes, etc.  </span>
<span id="cb32-105"><a href="#cb32-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-108"><a href="#cb32-108" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-109"><a href="#cb32-109" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb32-110"><a href="#cb32-110" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb32-111"><a href="#cb32-111" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tmp_meta) <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"-| |</span><span class="sc">\\</span><span class="st">.+"</span>, <span class="st">"_"</span>, <span class="fu">colnames</span>(tmp_meta))</span>
<span id="cb32-112"><a href="#cb32-112" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tmp_meta)[<span class="dv">12</span>] <span class="ot">&lt;-</span> <span class="st">"Species_pair"</span></span>
<span id="cb32-113"><a href="#cb32-113" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tmp_meta) <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"_Original"</span>, <span class="st">""</span>, <span class="fu">colnames</span>(tmp_meta))</span>
<span id="cb32-114"><a href="#cb32-114" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-115"><a href="#cb32-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-116"><a href="#cb32-116" aria-hidden="true" tabindex="-1"></a>Once this is finished we can go ahead and select columns in the metadata that are most important for downstream analysis. </span>
<span id="cb32-117"><a href="#cb32-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-120"><a href="#cb32-120" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-121"><a href="#cb32-121" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb32-122"><a href="#cb32-122" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb32-123"><a href="#cb32-123" aria-hidden="true" tabindex="-1"></a>tmp_meta <span class="ot">&lt;-</span> tmp_meta <span class="sc">%&gt;%</span> </span>
<span id="cb32-124"><a href="#cb32-124" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">relocate</span>(<span class="fu">c</span>(<span class="st">"Ocean"</span>, <span class="st">"Morphospecies"</span>, <span class="st">"Tissue"</span>, </span>
<span id="cb32-125"><a href="#cb32-125" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"Habitat"</span>, <span class="st">"Site"</span>, <span class="st">"Site_2"</span>, <span class="st">"Taxon"</span>, </span>
<span id="cb32-126"><a href="#cb32-126" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"Length"</span>, <span class="st">"Station_no"</span>, <span class="st">"Species_pair"</span>, </span>
<span id="cb32-127"><a href="#cb32-127" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"Species_group"</span>, <span class="st">"Species_complex"</span>, </span>
<span id="cb32-128"><a href="#cb32-128" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"Plate"</span>, <span class="st">"Row"</span>, <span class="st">"Column"</span>), </span>
<span id="cb32-129"><a href="#cb32-129" aria-hidden="true" tabindex="-1"></a>                  <span class="at">.after =</span> <span class="st">"Original_name"</span>)</span>
<span id="cb32-130"><a href="#cb32-130" aria-hidden="true" tabindex="-1"></a>tmp_meta[<span class="dv">17</span><span class="sc">:</span><span class="fu">ncol</span>(tmp_meta)] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb32-131"><a href="#cb32-131" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-132"><a href="#cb32-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-133"><a href="#cb32-133" aria-hidden="true" tabindex="-1"></a>At this point we need to standardize some of the values in the metadata categories. This includes things like replacing spaces with underscores (<span class="in">`_`</span>). The goal here is to eliminate anything that may cause issues later in the workflows. </span>
<span id="cb32-134"><a href="#cb32-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-137"><a href="#cb32-137" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-138"><a href="#cb32-138" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb32-139"><a href="#cb32-139" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb32-140"><a href="#cb32-140" aria-hidden="true" tabindex="-1"></a>tmp_meta <span class="ot">&lt;-</span> tmp_meta <span class="sc">%&gt;%</span></span>
<span id="cb32-141"><a href="#cb32-141" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fix specific replacements</span></span>
<span id="cb32-142"><a href="#cb32-142" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb32-143"><a href="#cb32-143" aria-hidden="true" tabindex="-1"></a>    <span class="at">Ocean =</span> <span class="fu">str_replace_all</span>(Ocean, <span class="fu">c</span>(</span>
<span id="cb32-144"><a href="#cb32-144" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Pacific"</span> <span class="ot">=</span> <span class="st">"Eastern_Pacific"</span>,</span>
<span id="cb32-145"><a href="#cb32-145" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Western Atlantic"</span> <span class="ot">=</span> <span class="st">"Western_Atlantic"</span></span>
<span id="cb32-146"><a href="#cb32-146" aria-hidden="true" tabindex="-1"></a>    )),</span>
<span id="cb32-147"><a href="#cb32-147" aria-hidden="true" tabindex="-1"></a>    <span class="at">Taxon =</span> <span class="fu">str_replace_all</span>(Taxon, <span class="st">"Snapping shrimp"</span>, <span class="st">"Snapping_shrimp"</span>)</span>
<span id="cb32-148"><a href="#cb32-148" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb32-149"><a href="#cb32-149" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-150"><a href="#cb32-150" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Normalize text by replacing spaces/dots in multiple columns</span></span>
<span id="cb32-151"><a href="#cb32-151" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb32-152"><a href="#cb32-152" aria-hidden="true" tabindex="-1"></a>    <span class="at">Morphospecies =</span> <span class="fu">str_replace_all</span>(Morphospecies, <span class="st">" +"</span>, <span class="st">"_"</span>),</span>
<span id="cb32-153"><a href="#cb32-153" aria-hidden="true" tabindex="-1"></a>    <span class="at">Species_pair  =</span> <span class="fu">str_replace_all</span>(Species_pair, <span class="fu">c</span>(</span>
<span id="cb32-154"><a href="#cb32-154" aria-hidden="true" tabindex="-1"></a>      <span class="st">"</span><span class="sc">\\</span><span class="st">. +"</span> <span class="ot">=</span> <span class="st">"_"</span>,</span>
<span id="cb32-155"><a href="#cb32-155" aria-hidden="true" tabindex="-1"></a>      <span class="st">" / "</span>   <span class="ot">=</span> <span class="st">"-"</span>,</span>
<span id="cb32-156"><a href="#cb32-156" aria-hidden="true" tabindex="-1"></a>      <span class="st">" +"</span>    <span class="ot">=</span> <span class="st">"_"</span></span>
<span id="cb32-157"><a href="#cb32-157" aria-hidden="true" tabindex="-1"></a>    )),</span>
<span id="cb32-158"><a href="#cb32-158" aria-hidden="true" tabindex="-1"></a>    <span class="at">Species_group   =</span> <span class="fu">str_replace_all</span>(Species_group, <span class="fu">c</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">. "</span> <span class="ot">=</span> <span class="st">"_"</span>, <span class="st">" "</span> <span class="ot">=</span> <span class="st">"_"</span>)),</span>
<span id="cb32-159"><a href="#cb32-159" aria-hidden="true" tabindex="-1"></a>    <span class="at">Species_complex =</span> <span class="fu">str_replace_all</span>(Species_complex, <span class="st">"</span><span class="sc">\\</span><span class="st">. "</span>, <span class="st">"_"</span>),</span>
<span id="cb32-160"><a href="#cb32-160" aria-hidden="true" tabindex="-1"></a>    <span class="at">Habitat   =</span> <span class="fu">str_replace_all</span>(Habitat, <span class="st">" +"</span>, <span class="st">"_"</span>),</span>
<span id="cb32-161"><a href="#cb32-161" aria-hidden="true" tabindex="-1"></a>    <span class="at">Site      =</span> <span class="fu">str_replace_all</span>(Site, <span class="st">" +"</span>, <span class="st">"_"</span>),</span>
<span id="cb32-162"><a href="#cb32-162" aria-hidden="true" tabindex="-1"></a>    <span class="at">Site_2    =</span> <span class="fu">str_replace_all</span>(Site_2, <span class="st">" +"</span>, <span class="st">"_"</span>),</span>
<span id="cb32-163"><a href="#cb32-163" aria-hidden="true" tabindex="-1"></a>    <span class="at">Plate     =</span> <span class="fu">str_replace_all</span>(Plate, <span class="st">" "</span>, <span class="st">"_"</span>)</span>
<span id="cb32-164"><a href="#cb32-164" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb32-165"><a href="#cb32-165" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-166"><a href="#cb32-166" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Map multiple Taxon values to "Environmental"</span></span>
<span id="cb32-167"><a href="#cb32-167" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb32-168"><a href="#cb32-168" aria-hidden="true" tabindex="-1"></a>    <span class="at">Taxon =</span> <span class="fu">str_replace_all</span>(Taxon, <span class="fu">c</span>(</span>
<span id="cb32-169"><a href="#cb32-169" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Rubble"</span>   <span class="ot">=</span> <span class="st">"Environmental"</span>, </span>
<span id="cb32-170"><a href="#cb32-170" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Sediment"</span> <span class="ot">=</span> <span class="st">"Environmental"</span>, </span>
<span id="cb32-171"><a href="#cb32-171" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Mud"</span>      <span class="ot">=</span> <span class="st">"Environmental"</span>,</span>
<span id="cb32-172"><a href="#cb32-172" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Water"</span>    <span class="ot">=</span> <span class="st">"Environmental"</span></span>
<span id="cb32-173"><a href="#cb32-173" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb32-174"><a href="#cb32-174" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb32-175"><a href="#cb32-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-176"><a href="#cb32-176" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace NA in Morphospecies with "Environmental"</span></span>
<span id="cb32-177"><a href="#cb32-177" aria-hidden="true" tabindex="-1"></a>tmp_meta <span class="ot">&lt;-</span> tmp_meta <span class="sc">%&gt;%</span></span>
<span id="cb32-178"><a href="#cb32-178" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Morphospecies =</span> <span class="fu">replace_na</span>(Morphospecies, <span class="st">"Environmental"</span>))</span>
<span id="cb32-179"><a href="#cb32-179" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-180"><a href="#cb32-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-181"><a href="#cb32-181" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Shortcodes</span></span>
<span id="cb32-182"><a href="#cb32-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-183"><a href="#cb32-183" aria-hidden="true" tabindex="-1"></a>Next we want to create more meaningful sample names. For this we generate some *shortcodes* that capture key information about each sample, specifically:</span>
<span id="cb32-184"><a href="#cb32-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-185"><a href="#cb32-185" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>the sampling ocean</span>
<span id="cb32-186"><a href="#cb32-186" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>the species name</span>
<span id="cb32-187"><a href="#cb32-187" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>the tissue type</span>
<span id="cb32-188"><a href="#cb32-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-189"><a href="#cb32-189" aria-hidden="true" tabindex="-1"></a>These we will combine with the unique individual ID number to get the new name. </span>
<span id="cb32-190"><a href="#cb32-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-191"><a href="#cb32-191" aria-hidden="true" tabindex="-1"></a>For example, something like <span class="in">`EP_A_HEBE_GL_8937`</span> is the gill tissue (**GL**) from an *Alpheus hebes* (**A-HEBE**), individual ID **8937**, collected in the Eastern Pacific (**EP**). </span>
<span id="cb32-192"><a href="#cb32-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-193"><a href="#cb32-193" aria-hidden="true" tabindex="-1"></a>We use a similar convention for environmental samples, but instead of species name, we use <span class="in">`E_SAMP`</span> to delineate environmental samples. For example, <span class="in">`WA_E_SAMP_WT_3075`</span> is a water sample (**WT**) collected from the Western Atlantic (**WA**), unique id **3075**.</span>
<span id="cb32-194"><a href="#cb32-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-197"><a href="#cb32-197" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-198"><a href="#cb32-198" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb32-199"><a href="#cb32-199" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb32-200"><a href="#cb32-200" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb32-201"><a href="#cb32-201" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Click to see the the shortcodes for each variable."</span></span>
<span id="cb32-202"><a href="#cb32-202" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: "list (old = new)"</span></span>
<span id="cb32-203"><a href="#cb32-203" aria-hidden="true" tabindex="-1"></a>tmp_ocean <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb32-204"><a href="#cb32-204" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Control"</span> <span class="ot">=</span> <span class="st">"CON"</span>,</span>
<span id="cb32-205"><a href="#cb32-205" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Eastern_Pacific"</span> <span class="ot">=</span> <span class="st">"EP"</span>,</span>
<span id="cb32-206"><a href="#cb32-206" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Western_Atlantic"</span> <span class="ot">=</span> <span class="st">"WA"</span></span>
<span id="cb32-207"><a href="#cb32-207" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-208"><a href="#cb32-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-209"><a href="#cb32-209" aria-hidden="true" tabindex="-1"></a>tmp_tissue <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb32-210"><a href="#cb32-210" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Control"</span> <span class="ot">=</span> <span class="st">"CON"</span>, </span>
<span id="cb32-211"><a href="#cb32-211" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Egg"</span> <span class="ot">=</span> <span class="st">"EG"</span>, </span>
<span id="cb32-212"><a href="#cb32-212" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Gill"</span> <span class="ot">=</span> <span class="st">"GL"</span>, </span>
<span id="cb32-213"><a href="#cb32-213" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Hepatopancreas"</span> <span class="ot">=</span> <span class="st">"HP"</span>, </span>
<span id="cb32-214"><a href="#cb32-214" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Midgut"</span> <span class="ot">=</span> <span class="st">"MG"</span>, </span>
<span id="cb32-215"><a href="#cb32-215" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Stomach"</span> <span class="ot">=</span> <span class="st">"ST"</span>, </span>
<span id="cb32-216"><a href="#cb32-216" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Mud"</span> <span class="ot">=</span> <span class="st">"MD"</span>, </span>
<span id="cb32-217"><a href="#cb32-217" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Rubble"</span> <span class="ot">=</span> <span class="st">"RB"</span>, </span>
<span id="cb32-218"><a href="#cb32-218" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Sediment"</span> <span class="ot">=</span> <span class="st">"SD"</span>, </span>
<span id="cb32-219"><a href="#cb32-219" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Water"</span> <span class="ot">=</span> <span class="st">"WT"</span></span>
<span id="cb32-220"><a href="#cb32-220" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-221"><a href="#cb32-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-222"><a href="#cb32-222" aria-hidden="true" tabindex="-1"></a>tmp_species <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb32-223"><a href="#cb32-223" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Control"</span> <span class="ot">=</span> <span class="st">"CON"</span>, </span>
<span id="cb32-224"><a href="#cb32-224" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Alpheus_arenensis"</span> <span class="ot">=</span> <span class="st">"A_AREN"</span>, </span>
<span id="cb32-225"><a href="#cb32-225" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Alpheus_bahamensis"</span> <span class="ot">=</span> <span class="st">"A_BAHA"</span>, </span>
<span id="cb32-226"><a href="#cb32-226" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Alpheus_bouvieri"</span> <span class="ot">=</span> <span class="st">"A_BOUV"</span>, </span>
<span id="cb32-227"><a href="#cb32-227" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Alpheus_cristulifrons"</span> <span class="ot">=</span> <span class="st">"A_CRIS"</span>, </span>
<span id="cb32-228"><a href="#cb32-228" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Alpheus_fasciatus"</span> <span class="ot">=</span> <span class="st">"A_FASC"</span>, </span>
<span id="cb32-229"><a href="#cb32-229" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Alpheus_floridanus"</span> <span class="ot">=</span> <span class="st">"A_FLOR"</span>, </span>
<span id="cb32-230"><a href="#cb32-230" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Alpheus_formosus"</span> <span class="ot">=</span> <span class="st">"A_FORM"</span>, </span>
<span id="cb32-231"><a href="#cb32-231" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Alpheus_galapagensis"</span> <span class="ot">=</span> <span class="st">"A_GALA"</span>, </span>
<span id="cb32-232"><a href="#cb32-232" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Alpheus_hebes"</span> <span class="ot">=</span> <span class="st">"A_HEBE"</span>, </span>
<span id="cb32-233"><a href="#cb32-233" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Alpheus_hephaestus"</span> <span class="ot">=</span> <span class="st">"A_HEPH"</span>, </span>
<span id="cb32-234"><a href="#cb32-234" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Alpheus_hyeyoungae"</span> <span class="ot">=</span> <span class="st">"A_HYEY"</span>, </span>
<span id="cb32-235"><a href="#cb32-235" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Alpheus_javieri"</span> <span class="ot">=</span> <span class="st">"A_JAVI"</span>, </span>
<span id="cb32-236"><a href="#cb32-236" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Alpheus_millsae"</span> <span class="ot">=</span> <span class="st">"A_MILL"</span>, </span>
<span id="cb32-237"><a href="#cb32-237" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Alpheus_nuttingi"</span> <span class="ot">=</span> <span class="st">"A_NUTT"</span>, </span>
<span id="cb32-238"><a href="#cb32-238" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Alpheus_panamensis"</span> <span class="ot">=</span> <span class="st">"A_PANA"</span>, </span>
<span id="cb32-239"><a href="#cb32-239" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Alpheus_paracrinitus_no_spot"</span> <span class="ot">=</span> <span class="st">"A_PCNS"</span>, </span>
<span id="cb32-240"><a href="#cb32-240" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Alpheus_paracrinitus_with_spot"</span> <span class="ot">=</span> <span class="st">"A_PCWS"</span>, </span>
<span id="cb32-241"><a href="#cb32-241" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Alpheus_paraformosus"</span> <span class="ot">=</span> <span class="st">"A_PARA"</span>, </span>
<span id="cb32-242"><a href="#cb32-242" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Alpheus_platycheirus"</span> <span class="ot">=</span> <span class="st">"A_PLAT"</span>, </span>
<span id="cb32-243"><a href="#cb32-243" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Alpheus_rostratus"</span> <span class="ot">=</span> <span class="st">"A_ROST"</span>, </span>
<span id="cb32-244"><a href="#cb32-244" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Alpheus_saxidomus"</span> <span class="ot">=</span> <span class="st">"A_SAXI"</span>, </span>
<span id="cb32-245"><a href="#cb32-245" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Alpheus_simus"</span> <span class="ot">=</span> <span class="st">"A_SIMU"</span>, </span>
<span id="cb32-246"><a href="#cb32-246" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Alpheus_thomasi"</span> <span class="ot">=</span> <span class="st">"A_THOM"</span>, </span>
<span id="cb32-247"><a href="#cb32-247" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Alpheus_umbo"</span> <span class="ot">=</span> <span class="st">"A_UMBO"</span>, </span>
<span id="cb32-248"><a href="#cb32-248" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Alpheus_utriensis"</span> <span class="ot">=</span> <span class="st">"A_UTRI"</span>, </span>
<span id="cb32-249"><a href="#cb32-249" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Alpheus_verrilli"</span> <span class="ot">=</span> <span class="st">"A_VERR"</span>, </span>
<span id="cb32-250"><a href="#cb32-250" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Alpheus_websteri"</span> <span class="ot">=</span> <span class="st">"A_WEBS"</span>, </span>
<span id="cb32-251"><a href="#cb32-251" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Environmental"</span> <span class="ot">=</span> <span class="st">"E_SAMP"</span>, </span>
<span id="cb32-252"><a href="#cb32-252" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Unknown"</span> <span class="ot">=</span> <span class="st">"UNKN"</span></span>
<span id="cb32-253"><a href="#cb32-253" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-254"><a href="#cb32-254" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-255"><a href="#cb32-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-256"><a href="#cb32-256" aria-hidden="true" tabindex="-1"></a>With these shortcodes in hand we can match each original sample names (from the fastq file names) to the shortcodes. </span>
<span id="cb32-257"><a href="#cb32-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-260"><a href="#cb32-260" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-261"><a href="#cb32-261" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb32-262"><a href="#cb32-262" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb32-263"><a href="#cb32-263" aria-hidden="true" tabindex="-1"></a>tmp_shortcode <span class="ot">&lt;-</span> tmp_meta</span>
<span id="cb32-264"><a href="#cb32-264" aria-hidden="true" tabindex="-1"></a>tmp_shortcode <span class="ot">&lt;-</span> tmp_shortcode <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">8</span>)</span>
<span id="cb32-265"><a href="#cb32-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-266"><a href="#cb32-266" aria-hidden="true" tabindex="-1"></a>tmp_shortcode <span class="ot">&lt;-</span> tmp_shortcode <span class="sc">%&gt;%</span></span>
<span id="cb32-267"><a href="#cb32-267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb32-268"><a href="#cb32-268" aria-hidden="true" tabindex="-1"></a>    <span class="at">Ocean_code   =</span> Ocean,</span>
<span id="cb32-269"><a href="#cb32-269" aria-hidden="true" tabindex="-1"></a>    <span class="at">Species_code =</span> Morphospecies,</span>
<span id="cb32-270"><a href="#cb32-270" aria-hidden="true" tabindex="-1"></a>    <span class="at">Tissue_code  =</span> Tissue</span>
<span id="cb32-271"><a href="#cb32-271" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb32-272"><a href="#cb32-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-273"><a href="#cb32-273" aria-hidden="true" tabindex="-1"></a>tmp_shortcode <span class="ot">&lt;-</span> tmp_shortcode <span class="sc">%&gt;%</span></span>
<span id="cb32-274"><a href="#cb32-274" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb32-275"><a href="#cb32-275" aria-hidden="true" tabindex="-1"></a>    <span class="at">Ocean_code   =</span> <span class="fu">str_replace_all</span>(Ocean, tmp_ocean),</span>
<span id="cb32-276"><a href="#cb32-276" aria-hidden="true" tabindex="-1"></a>    <span class="at">Species_code =</span> <span class="fu">str_replace_all</span>(Morphospecies, tmp_species),</span>
<span id="cb32-277"><a href="#cb32-277" aria-hidden="true" tabindex="-1"></a>    <span class="at">Tissue_code  =</span> <span class="fu">str_replace_all</span>(Tissue, tmp_tissue)</span>
<span id="cb32-278"><a href="#cb32-278" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb32-279"><a href="#cb32-279" aria-hidden="true" tabindex="-1"></a>tmp_shortcode<span class="sc">$</span>Ocean_code <span class="ot">&lt;-</span> tmp_shortcode<span class="sc">$</span>Ocean</span>
<span id="cb32-280"><a href="#cb32-280" aria-hidden="true" tabindex="-1"></a>tmp_shortcode <span class="ot">&lt;-</span> tmp_shortcode <span class="sc">%&gt;%</span></span>
<span id="cb32-281"><a href="#cb32-281" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Ocean_code =</span> <span class="fu">str_replace_all</span>(Ocean_code, tmp_ocean)) </span>
<span id="cb32-282"><a href="#cb32-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-283"><a href="#cb32-283" aria-hidden="true" tabindex="-1"></a>tmp_shortcode<span class="sc">$</span>Species_code <span class="ot">&lt;-</span> tmp_shortcode<span class="sc">$</span>Morphospecies</span>
<span id="cb32-284"><a href="#cb32-284" aria-hidden="true" tabindex="-1"></a>tmp_shortcode <span class="ot">&lt;-</span> tmp_shortcode <span class="sc">%&gt;%</span></span>
<span id="cb32-285"><a href="#cb32-285" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species_code =</span> <span class="fu">str_replace_all</span>(Species_code, tmp_species)) </span>
<span id="cb32-286"><a href="#cb32-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-287"><a href="#cb32-287" aria-hidden="true" tabindex="-1"></a>tmp_shortcode<span class="sc">$</span>Tissue_code <span class="ot">&lt;-</span> tmp_shortcode<span class="sc">$</span>Tissue</span>
<span id="cb32-288"><a href="#cb32-288" aria-hidden="true" tabindex="-1"></a>tmp_shortcode <span class="ot">&lt;-</span> tmp_shortcode <span class="sc">%&gt;%</span></span>
<span id="cb32-289"><a href="#cb32-289" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Tissue_code =</span> <span class="fu">str_replace_all</span>(Tissue_code, tmp_tissue)) </span>
<span id="cb32-290"><a href="#cb32-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-291"><a href="#cb32-291" aria-hidden="true" tabindex="-1"></a>tmp_shortcode[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb32-292"><a href="#cb32-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-293"><a href="#cb32-293" aria-hidden="true" tabindex="-1"></a>tmp_shortcode <span class="ot">&lt;-</span> tmp_shortcode <span class="sc">%&gt;%</span> </span>
<span id="cb32-294"><a href="#cb32-294" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">relocate</span>(<span class="st">"Taxon"</span>, <span class="at">.after =</span> <span class="st">"Tissue_code"</span>)</span>
<span id="cb32-295"><a href="#cb32-295" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-296"><a href="#cb32-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-299"><a href="#cb32-299" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-300"><a href="#cb32-300" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb32-301"><a href="#cb32-301" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb32-302"><a href="#cb32-302" aria-hidden="true" tabindex="-1"></a>head_short <span class="ot">&lt;-</span> <span class="fu">head</span>(tmp_shortcode)</span>
<span id="cb32-303"><a href="#cb32-303" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-304"><a href="#cb32-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-307"><a href="#cb32-307" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-308"><a href="#cb32-308" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb32-309"><a href="#cb32-309" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb32-310"><a href="#cb32-310" aria-hidden="true" tabindex="-1"></a><span class="fu">pandoc.table</span>(head_short, <span class="at">emphasize.rownames =</span> <span class="cn">FALSE</span>)</span>
<span id="cb32-311"><a href="#cb32-311" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-312"><a href="#cb32-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-313"><a href="#cb32-313" aria-hidden="true" tabindex="-1"></a>Still with me? Even though we have the pieces in place to standardize the sample names, we cannot do that yet because  different sample types have different initial naming conventions. For examples, Control samples are named like <span class="in">`Control-1`</span>, <span class="in">`Control-2`</span>, etc., while the snapping shrimp are named like <span class="in">`7322-M`</span>, <span class="in">`7322-H`</span>, etc. Environmental samples have totally different names, for example <span class="in">`Machete_scrap2`</span>, <span class="in">`ML2670`</span>, etc. This makes it a litle difficult to parse out meaningful information (specifically ID numbers) from the original sample names and apply our short codes to generate the new names. </span>
<span id="cb32-314"><a href="#cb32-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-315"><a href="#cb32-315" aria-hidden="true" tabindex="-1"></a>When we generated the short codes above we also included a column called <span class="in">`Taxon`</span>. These data tell us whether a the entry is a snapping shrimp, a control, or an environmental sample. </span>
<span id="cb32-316"><a href="#cb32-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-319"><a href="#cb32-319" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-320"><a href="#cb32-320" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb32-321"><a href="#cb32-321" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb32-322"><a href="#cb32-322" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(tmp_shortcode<span class="sc">$</span>Taxon)</span>
<span id="cb32-323"><a href="#cb32-323" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-324"><a href="#cb32-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-325"><a href="#cb32-325" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-326"><a href="#cb32-326" aria-hidden="true" tabindex="-1"></a><span class="in">[1] "Snapping_shrimp" "Control"  "Environmental"  </span></span>
<span id="cb32-327"><a href="#cb32-327" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-328"><a href="#cb32-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-329"><a href="#cb32-329" aria-hidden="true" tabindex="-1"></a>We can use the base R command <span class="in">`split`</span> to separate the dataset based on the <span class="in">`Taxon`</span> type so that we can process each category separately. </span>
<span id="cb32-330"><a href="#cb32-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-333"><a href="#cb32-333" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-334"><a href="#cb32-334" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb32-335"><a href="#cb32-335" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb32-336"><a href="#cb32-336" aria-hidden="true" tabindex="-1"></a>tmp_split_dfs <span class="ot">&lt;-</span> <span class="fu">split</span>(tmp_shortcode, tmp_shortcode<span class="sc">$</span>Taxon)</span>
<span id="cb32-337"><a href="#cb32-337" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-338"><a href="#cb32-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-339"><a href="#cb32-339" aria-hidden="true" tabindex="-1"></a>Generating three separate data frames. </span>
<span id="cb32-340"><a href="#cb32-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-341"><a href="#cb32-341" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-342"><a href="#cb32-342" aria-hidden="true" tabindex="-1"></a><span class="in">tmp_split_dfs$Control</span></span>
<span id="cb32-343"><a href="#cb32-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-344"><a href="#cb32-344" aria-hidden="true" tabindex="-1"></a><span class="in">tmp_split_dfs$Environmental</span></span>
<span id="cb32-345"><a href="#cb32-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-346"><a href="#cb32-346" aria-hidden="true" tabindex="-1"></a><span class="in">tmp_split_dfs$Snapping_shrimp</span></span>
<span id="cb32-347"><a href="#cb32-347" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-348"><a href="#cb32-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-349"><a href="#cb32-349" aria-hidden="true" tabindex="-1"></a><span class="fu">### Control samples</span></span>
<span id="cb32-350"><a href="#cb32-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-353"><a href="#cb32-353" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-354"><a href="#cb32-354" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb32-355"><a href="#cb32-355" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb32-356"><a href="#cb32-356" aria-hidden="true" tabindex="-1"></a>tmp_control <span class="ot">&lt;-</span> tmp_split_dfs<span class="sc">$</span>Control</span>
<span id="cb32-357"><a href="#cb32-357" aria-hidden="true" tabindex="-1"></a>tmp_control<span class="sc">$</span>tmp <span class="ot">&lt;-</span> tmp_control<span class="sc">$</span>Original_name</span>
<span id="cb32-358"><a href="#cb32-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-359"><a href="#cb32-359" aria-hidden="true" tabindex="-1"></a>tmp_control <span class="ot">&lt;-</span> tmp_control <span class="sc">%&gt;%</span></span>
<span id="cb32-360"><a href="#cb32-360" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_wider_delim</span>(tmp, <span class="at">delim =</span> <span class="st">"-"</span>, <span class="at">names =</span> <span class="fu">c</span>(<span class="st">"tmp1"</span>, <span class="st">"ID"</span>))</span>
<span id="cb32-361"><a href="#cb32-361" aria-hidden="true" tabindex="-1"></a>tmp_control<span class="sc">$</span>tmp1 <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb32-362"><a href="#cb32-362" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-363"><a href="#cb32-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-364"><a href="#cb32-364" aria-hidden="true" tabindex="-1"></a><span class="fu">### Environmental samples</span></span>
<span id="cb32-365"><a href="#cb32-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-368"><a href="#cb32-368" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-369"><a href="#cb32-369" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb32-370"><a href="#cb32-370" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb32-371"><a href="#cb32-371" aria-hidden="true" tabindex="-1"></a>tmp_envr <span class="ot">&lt;-</span> tmp_split_dfs<span class="sc">$</span>Environmental</span>
<span id="cb32-372"><a href="#cb32-372" aria-hidden="true" tabindex="-1"></a>tmp_envr<span class="sc">$</span>tmp <span class="ot">&lt;-</span> tmp_envr<span class="sc">$</span>Original_name</span>
<span id="cb32-373"><a href="#cb32-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-374"><a href="#cb32-374" aria-hidden="true" tabindex="-1"></a>tmp_envr <span class="ot">&lt;-</span> tmp_envr <span class="sc">%&gt;%</span></span>
<span id="cb32-375"><a href="#cb32-375" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_wider_delim</span>(tmp,</span>
<span id="cb32-376"><a href="#cb32-376" aria-hidden="true" tabindex="-1"></a>                       <span class="at">delim =</span> stringr<span class="sc">::</span><span class="fu">regex</span>(<span class="st">"(_)|(ML)"</span>),</span>
<span id="cb32-377"><a href="#cb32-377" aria-hidden="true" tabindex="-1"></a>                       <span class="at">too_few =</span> <span class="st">"align_start"</span>,</span>
<span id="cb32-378"><a href="#cb32-378" aria-hidden="true" tabindex="-1"></a>                       <span class="at">names_sep =</span> <span class="st">""</span>,</span>
<span id="cb32-379"><a href="#cb32-379" aria-hidden="true" tabindex="-1"></a>                       <span class="at">names_repair =</span> <span class="sc">~</span> <span class="fu">sub</span>(<span class="st">"value"</span>, <span class="st">"X"</span>, .x))</span>
<span id="cb32-380"><a href="#cb32-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-381"><a href="#cb32-381" aria-hidden="true" tabindex="-1"></a>tmp_envr<span class="sc">$</span>tmp2 <span class="ot">&lt;-</span> <span class="fu">str_replace</span>(tmp_envr<span class="sc">$</span>tmp2, <span class="st">"(</span><span class="sc">\\</span><span class="st">d+).*"</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">1"</span>)</span>
<span id="cb32-382"><a href="#cb32-382" aria-hidden="true" tabindex="-1"></a>tmp_envr<span class="sc">$</span>tmp2 <span class="ot">&lt;-</span> <span class="fu">str_replace</span>(tmp_envr<span class="sc">$</span>tmp2, <span class="st">"Sed"</span>, <span class="st">"sed"</span>)</span>
<span id="cb32-383"><a href="#cb32-383" aria-hidden="true" tabindex="-1"></a>tmp_envr<span class="sc">$</span>tmp1 <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb32-384"><a href="#cb32-384" aria-hidden="true" tabindex="-1"></a>tmp_envr <span class="ot">&lt;-</span> tmp_envr <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">ID =</span> tmp2)</span>
<span id="cb32-385"><a href="#cb32-385" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-386"><a href="#cb32-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-387"><a href="#cb32-387" aria-hidden="true" tabindex="-1"></a><span class="fu">### Shrimp samples</span></span>
<span id="cb32-388"><a href="#cb32-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-391"><a href="#cb32-391" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-392"><a href="#cb32-392" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb32-393"><a href="#cb32-393" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb32-394"><a href="#cb32-394" aria-hidden="true" tabindex="-1"></a>tmp_shrmp <span class="ot">&lt;-</span> tmp_split_dfs<span class="sc">$</span>Snapping_shrimp</span>
<span id="cb32-395"><a href="#cb32-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-396"><a href="#cb32-396" aria-hidden="true" tabindex="-1"></a>tmp_shrmp<span class="sc">$</span>tmp <span class="ot">&lt;-</span> tmp_shrmp<span class="sc">$</span>Original_name</span>
<span id="cb32-397"><a href="#cb32-397" aria-hidden="true" tabindex="-1"></a>tmp_shrmp <span class="sc">%&gt;%</span></span>
<span id="cb32-398"><a href="#cb32-398" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Original_name <span class="sc">==</span> <span class="st">"7332-H-M"</span>)</span>
<span id="cb32-399"><a href="#cb32-399" aria-hidden="true" tabindex="-1"></a>tmp_shrmp<span class="sc">$</span>tmp <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"7332-H-M"</span>, <span class="st">"7332M-H"</span>, tmp_shrmp<span class="sc">$</span>tmp)</span>
<span id="cb32-400"><a href="#cb32-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-401"><a href="#cb32-401" aria-hidden="true" tabindex="-1"></a>tmp_shrmp <span class="ot">&lt;-</span> tmp_shrmp <span class="sc">%&gt;%</span></span>
<span id="cb32-402"><a href="#cb32-402" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_wider_delim</span>(tmp,</span>
<span id="cb32-403"><a href="#cb32-403" aria-hidden="true" tabindex="-1"></a>                       <span class="at">delim =</span> <span class="st">"-"</span>,</span>
<span id="cb32-404"><a href="#cb32-404" aria-hidden="true" tabindex="-1"></a>                       <span class="at">names =</span> <span class="fu">c</span>(<span class="st">"tmp1"</span>, <span class="st">"tmp2"</span>)</span>
<span id="cb32-405"><a href="#cb32-405" aria-hidden="true" tabindex="-1"></a>                       )</span>
<span id="cb32-406"><a href="#cb32-406" aria-hidden="true" tabindex="-1"></a>tmp_shrmp <span class="sc">%&gt;%</span></span>
<span id="cb32-407"><a href="#cb32-407" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Original_name <span class="sc">==</span> <span class="st">"7332-H-M"</span>)</span>
<span id="cb32-408"><a href="#cb32-408" aria-hidden="true" tabindex="-1"></a>tmp_shrmp<span class="sc">$</span>tmp2 <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb32-409"><a href="#cb32-409" aria-hidden="true" tabindex="-1"></a>tmp_shrmp <span class="ot">&lt;-</span> tmp_shrmp <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">ID =</span> tmp1)</span>
<span id="cb32-410"><a href="#cb32-410" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-411"><a href="#cb32-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-412"><a href="#cb32-412" aria-hidden="true" tabindex="-1"></a>Sweet. At this point we can generate the new unique name for each sample based on the criteria listed above. </span>
<span id="cb32-413"><a href="#cb32-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-416"><a href="#cb32-416" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-417"><a href="#cb32-417" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb32-418"><a href="#cb32-418" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb32-419"><a href="#cb32-419" aria-hidden="true" tabindex="-1"></a>tmp_control<span class="sc">$</span>SampleID <span class="ot">&lt;-</span> tmp_control<span class="sc">$</span>Original_name</span>
<span id="cb32-420"><a href="#cb32-420" aria-hidden="true" tabindex="-1"></a>tmp_control<span class="sc">$</span>SampleID <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"-"</span>, <span class="st">"_"</span>, tmp_control<span class="sc">$</span>SampleID)</span>
<span id="cb32-421"><a href="#cb32-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-422"><a href="#cb32-422" aria-hidden="true" tabindex="-1"></a>tmp_envr <span class="ot">&lt;-</span> tmp_envr <span class="sc">%&gt;%</span></span>
<span id="cb32-423"><a href="#cb32-423" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SampleID =</span> <span class="fu">paste</span>(Ocean_code, </span>
<span id="cb32-424"><a href="#cb32-424" aria-hidden="true" tabindex="-1"></a>                          Species_code, </span>
<span id="cb32-425"><a href="#cb32-425" aria-hidden="true" tabindex="-1"></a>                          Tissue_code, </span>
<span id="cb32-426"><a href="#cb32-426" aria-hidden="true" tabindex="-1"></a>                          ID, </span>
<span id="cb32-427"><a href="#cb32-427" aria-hidden="true" tabindex="-1"></a>                          <span class="at">sep =</span> <span class="st">"_"</span>))</span>
<span id="cb32-428"><a href="#cb32-428" aria-hidden="true" tabindex="-1"></a>tmp_shrmp <span class="ot">&lt;-</span> tmp_shrmp <span class="sc">%&gt;%</span></span>
<span id="cb32-429"><a href="#cb32-429" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SampleID =</span> <span class="fu">paste</span>(Ocean_code, </span>
<span id="cb32-430"><a href="#cb32-430" aria-hidden="true" tabindex="-1"></a>                          Species_code, </span>
<span id="cb32-431"><a href="#cb32-431" aria-hidden="true" tabindex="-1"></a>                          Tissue_code, </span>
<span id="cb32-432"><a href="#cb32-432" aria-hidden="true" tabindex="-1"></a>                          ID, </span>
<span id="cb32-433"><a href="#cb32-433" aria-hidden="true" tabindex="-1"></a>                          <span class="at">sep =</span> <span class="st">"_"</span>))</span>
<span id="cb32-434"><a href="#cb32-434" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-435"><a href="#cb32-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-436"><a href="#cb32-436" aria-hidden="true" tabindex="-1"></a>And combine the three modified data frames. </span>
<span id="cb32-437"><a href="#cb32-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-440"><a href="#cb32-440" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-441"><a href="#cb32-441" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb32-442"><a href="#cb32-442" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb32-443"><a href="#cb32-443" aria-hidden="true" tabindex="-1"></a>tmp_combo <span class="ot">&lt;-</span> <span class="fu">rbind</span>(tmp_control, tmp_envr, tmp_shrmp)</span>
<span id="cb32-444"><a href="#cb32-444" aria-hidden="true" tabindex="-1"></a>tmp_combo<span class="sc">$</span>Taxon <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb32-445"><a href="#cb32-445" aria-hidden="true" tabindex="-1"></a>shortcodes <span class="ot">&lt;-</span> tmp_combo</span>
<span id="cb32-446"><a href="#cb32-446" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-447"><a href="#cb32-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-448"><a href="#cb32-448" aria-hidden="true" tabindex="-1"></a>And generate a modified metadata file containing the new sample ID plus the original and modified fastq file names. We have a four column tab delimited text file called <span class="in">`fastq_info.txt`</span> that contains the original sample names, the run ID, plus the original    forward and reverse fastq file names.</span>
<span id="cb32-449"><a href="#cb32-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-452"><a href="#cb32-452" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-453"><a href="#cb32-453" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb32-454"><a href="#cb32-454" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb32-455"><a href="#cb32-455" aria-hidden="true" tabindex="-1"></a>tmp_combo[<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb32-456"><a href="#cb32-456" aria-hidden="true" tabindex="-1"></a>tmp_fastq <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="fu">here</span>(work_here, <span class="st">"fastq_info.txt"</span>))</span>
<span id="cb32-457"><a href="#cb32-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-458"><a href="#cb32-458" aria-hidden="true" tabindex="-1"></a>all_metadata <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(tmp_meta, tmp_combo, <span class="at">by =</span> <span class="st">"Original_name"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-459"><a href="#cb32-459" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(., tmp_fastq, <span class="at">by =</span> <span class="st">"Original_name"</span>)</span>
<span id="cb32-460"><a href="#cb32-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-461"><a href="#cb32-461" aria-hidden="true" tabindex="-1"></a>all_metadata <span class="ot">&lt;-</span> all_metadata <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">relocate</span>(<span class="st">"SampleID"</span>, </span>
<span id="cb32-462"><a href="#cb32-462" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">.before =</span> <span class="st">"Original_name"</span>)</span>
<span id="cb32-463"><a href="#cb32-463" aria-hidden="true" tabindex="-1"></a>all_metadata <span class="ot">&lt;-</span> all_metadata <span class="sc">%&gt;%</span> </span>
<span id="cb32-464"><a href="#cb32-464" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">relocate</span>(<span class="st">"Run"</span>, <span class="at">.before =</span> <span class="st">"Plate"</span>)</span>
<span id="cb32-465"><a href="#cb32-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-466"><a href="#cb32-466" aria-hidden="true" tabindex="-1"></a>all_metadata <span class="ot">&lt;-</span> all_metadata <span class="sc">%&gt;%</span></span>
<span id="cb32-467"><a href="#cb32-467" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Fastq_ID_forward_rename =</span> <span class="fu">paste0</span>(SampleID, <span class="st">"_R1.fastq.gz"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb32-468"><a href="#cb32-468" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Fastq_ID_forward_rename, <span class="at">.after =</span> Fastq_ID_forward_original) <span class="sc">%&gt;%</span></span>
<span id="cb32-469"><a href="#cb32-469" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Fastq_ID_reverse_rename =</span> <span class="fu">paste0</span>(SampleID, <span class="st">"_R2.fastq.gz"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb32-470"><a href="#cb32-470" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Fastq_ID_reverse_rename, <span class="at">.after =</span> Fastq_ID_reverse_original)</span>
<span id="cb32-471"><a href="#cb32-471" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-472"><a href="#cb32-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-473"><a href="#cb32-473" aria-hidden="true" tabindex="-1"></a><span class="fu">## Modified Metadata</span></span>
<span id="cb32-474"><a href="#cb32-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-475"><a href="#cb32-475" aria-hidden="true" tabindex="-1"></a>And here is the modified metadata. </span>
<span id="cb32-476"><a href="#cb32-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-477"><a href="#cb32-477" aria-hidden="true" tabindex="-1"></a>::: {.callout-note appearance="simple" collapse="true"}</span>
<span id="cb32-478"><a href="#cb32-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-479"><a href="#cb32-479" aria-hidden="true" tabindex="-1"></a><span class="fu">### Expand to column descriptions for sample table</span></span>
<span id="cb32-480"><a href="#cb32-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-481"><a href="#cb32-481" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Header                      <span class="pp">|</span> Description                                            <span class="pp">|</span></span>
<span id="cb32-482"><a href="#cb32-482" aria-hidden="true" tabindex="-1"></a><span class="pp">|-----------------------------|----------------------------------------------|</span></span>
<span id="cb32-483"><a href="#cb32-483" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`SampleID`</span>                  <span class="pp">|</span> Sample ID based on Ocean, species, tissue, &amp; unique ID <span class="pp">|</span></span>
<span id="cb32-484"><a href="#cb32-484" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`Original_name`</span>             <span class="pp">|</span> Original sample ID                                     <span class="pp">|</span></span>
<span id="cb32-485"><a href="#cb32-485" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`Ocean`</span>                     <span class="pp">|</span> Sampling ocean                                         <span class="pp">|</span></span>
<span id="cb32-486"><a href="#cb32-486" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`Morphospecies`</span>             <span class="pp">|</span> Host shrimp species                                    <span class="pp">|</span></span>
<span id="cb32-487"><a href="#cb32-487" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`Tissue`</span>                    <span class="pp">|</span> Shrimp tissue type                                     <span class="pp">|</span></span>
<span id="cb32-488"><a href="#cb32-488" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`Habitat`</span>                   <span class="pp">|</span> Sampling habitat                                       <span class="pp">|</span></span>
<span id="cb32-489"><a href="#cb32-489" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`Site`</span>                      <span class="pp">|</span> Sampling Site 1                                        <span class="pp">|</span></span>
<span id="cb32-490"><a href="#cb32-490" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`Site_2`</span>                    <span class="pp">|</span> Sampling Site 2                                        <span class="pp">|</span></span>
<span id="cb32-491"><a href="#cb32-491" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`Taxon`</span>                     <span class="pp">|</span> Shrimp, environmental samples, or Controls             <span class="pp">|</span></span>
<span id="cb32-492"><a href="#cb32-492" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`Length`</span>                    <span class="pp">|</span> Length of individual                                   <span class="pp">|</span></span>
<span id="cb32-493"><a href="#cb32-493" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`Station_no`</span>                <span class="pp">|</span> ASK MATT                                               <span class="pp">|</span></span>
<span id="cb32-494"><a href="#cb32-494" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`Species_pair`</span>              <span class="pp">|</span> ASK MATT                                               <span class="pp">|</span></span>
<span id="cb32-495"><a href="#cb32-495" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`Species_group`</span>             <span class="pp">|</span> ASK MATT                                               <span class="pp">|</span></span>
<span id="cb32-496"><a href="#cb32-496" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`Species_complex`</span>           <span class="pp">|</span> ASK MATT                                               <span class="pp">|</span></span>
<span id="cb32-497"><a href="#cb32-497" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`Run`</span>                       <span class="pp">|</span> Sequencing run ID                                      <span class="pp">|</span></span>
<span id="cb32-498"><a href="#cb32-498" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`Plate`</span>                     <span class="pp">|</span> Sequencing plate ID                                    <span class="pp">|</span></span>
<span id="cb32-499"><a href="#cb32-499" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`Row`</span>                       <span class="pp">|</span> Sequencing plate row number                            <span class="pp">|</span></span>
<span id="cb32-500"><a href="#cb32-500" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`Column`</span>                    <span class="pp">|</span> Sequencing plate column number                         <span class="pp">|</span></span>
<span id="cb32-501"><a href="#cb32-501" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`Fastq_ID_forward_original`</span> <span class="pp">|</span> Original fastq ID (F)                                  <span class="pp">|</span></span>
<span id="cb32-502"><a href="#cb32-502" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`Fastq_ID_forward_rename`</span>   <span class="pp">|</span> New fastq ID (F)                                       <span class="pp">|</span></span>
<span id="cb32-503"><a href="#cb32-503" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`Fastq_ID_reverse_original`</span> <span class="pp">|</span> Original fastq ID (R)                                  <span class="pp">|</span></span>
<span id="cb32-504"><a href="#cb32-504" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`Fastq_ID_reverse_rename`</span>   <span class="pp">|</span> New fastq ID (R)                                       <span class="pp">|</span></span>
<span id="cb32-505"><a href="#cb32-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-506"><a href="#cb32-506" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb32-507"><a href="#cb32-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-508"><a href="#cb32-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-509"><a href="#cb32-509" aria-hidden="true" tabindex="-1"></a>We sequenced a total of <span class="in">`r nrow(all_metadata)`</span> samples, including <span class="in">`r nrow(all_metadata %&gt;% filter(str_detect(Taxon, 'Snapping_shrimp')))`</span> shrimp samples, <span class="in">`r nrow(all_metadata %&gt;% filter(str_detect(Taxon, 'Environmental')))`</span> environmental samples, and <span class="in">`r nrow(all_metadata %&gt;% filter(str_detect(Taxon, 'Control')))`</span> control samples. <span class="in">`r nrow(filter(all_metadata, Ocean == "Eastern_Pacific"))`</span> total samples came from the Eastern Pacific and <span class="in">`r nrow(filter(all_metadata, Ocean == "Western_Atlantic"))`</span> from the Western Atlantic.</span>
<span id="cb32-510"><a href="#cb32-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-511"><a href="#cb32-511" aria-hidden="true" tabindex="-1"></a><span class="fu">## Rename FastQ Files</span></span>
<span id="cb32-512"><a href="#cb32-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-513"><a href="#cb32-513" aria-hidden="true" tabindex="-1"></a>Using the modified metadata, specifically the new sample names, we can rename all fastq file prior to processing the data. To batch rename samples we created tab-delimited *lookup tables*, where the first column contains the original name of each fastq file while the second column corresponds to the new name. We did this for each sequencing run. Here is an example of the first few samples from the lookup table for run BCS_34, which we call <span class="in">`BCS_34.rename.txt`</span></span>
<span id="cb32-514"><a href="#cb32-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-515"><a href="#cb32-515" aria-hidden="true" tabindex="-1"></a><span class="in">```         </span></span>
<span id="cb32-516"><a href="#cb32-516" aria-hidden="true" tabindex="-1"></a><span class="in">8937-G_R1_001.trimmed.fastq EP_A_HEBE_GL_8937_R1_001.trimmed.fastq</span></span>
<span id="cb32-517"><a href="#cb32-517" aria-hidden="true" tabindex="-1"></a><span class="in">8937-H_R1_001.trimmed.fastq EP_A_HEBE_HP_8937_R1_001.trimmed.fastq</span></span>
<span id="cb32-518"><a href="#cb32-518" aria-hidden="true" tabindex="-1"></a><span class="in">8937-M_R1_001.trimmed.fastq EP_A_HEBE_MG_8937_R1_001.trimmed.fastq</span></span>
<span id="cb32-519"><a href="#cb32-519" aria-hidden="true" tabindex="-1"></a><span class="in">8937-S_R1_001.trimmed.fastq EP_A_HEBE_ST_8937_R1_001.trimmed.fastq</span></span>
<span id="cb32-520"><a href="#cb32-520" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-521"><a href="#cb32-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-522"><a href="#cb32-522" aria-hidden="true" tabindex="-1"></a>We use the new metadata file and the base R command <span class="in">`split`</span> to generate initial lookup tables for each of the six sequencing runs. </span>
<span id="cb32-523"><a href="#cb32-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-526"><a href="#cb32-526" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-527"><a href="#cb32-527" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb32-528"><a href="#cb32-528" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb32-529"><a href="#cb32-529" aria-hidden="true" tabindex="-1"></a>tmp_split_dfs <span class="ot">&lt;-</span> all_metadata</span>
<span id="cb32-530"><a href="#cb32-530" aria-hidden="true" tabindex="-1"></a>tmp_split_dfs <span class="ot">&lt;-</span> tmp_split_dfs <span class="sc">%&gt;%</span> </span>
<span id="cb32-531"><a href="#cb32-531" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Run, </span>
<span id="cb32-532"><a href="#cb32-532" aria-hidden="true" tabindex="-1"></a>                Fastq_ID_forward_original, </span>
<span id="cb32-533"><a href="#cb32-533" aria-hidden="true" tabindex="-1"></a>                Fastq_ID_forward_rename, </span>
<span id="cb32-534"><a href="#cb32-534" aria-hidden="true" tabindex="-1"></a>                Fastq_ID_reverse_original, </span>
<span id="cb32-535"><a href="#cb32-535" aria-hidden="true" tabindex="-1"></a>                Fastq_ID_reverse_rename)</span>
<span id="cb32-536"><a href="#cb32-536" aria-hidden="true" tabindex="-1"></a>split_dfs <span class="ot">&lt;-</span> <span class="fu">split</span>(tmp_split_dfs, tmp_split_dfs<span class="sc">$</span>Run)</span>
<span id="cb32-537"><a href="#cb32-537" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-538"><a href="#cb32-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-539"><a href="#cb32-539" aria-hidden="true" tabindex="-1"></a>Again, a partial example from run BCS_34. </span>
<span id="cb32-540"><a href="#cb32-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-543"><a href="#cb32-543" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-544"><a href="#cb32-544" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb32-545"><a href="#cb32-545" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb32-546"><a href="#cb32-546" aria-hidden="true" tabindex="-1"></a>head_split_dfs <span class="ot">&lt;-</span> split_dfs<span class="sc">$</span>BCS_34[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb32-547"><a href="#cb32-547" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-548"><a href="#cb32-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-551"><a href="#cb32-551" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-552"><a href="#cb32-552" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb32-553"><a href="#cb32-553" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb32-554"><a href="#cb32-554" aria-hidden="true" tabindex="-1"></a><span class="fu">pandoc.table</span>(head_split_dfs, <span class="at">emphasize.rownames =</span> <span class="cn">FALSE</span>)</span>
<span id="cb32-555"><a href="#cb32-555" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-556"><a href="#cb32-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-557"><a href="#cb32-557" aria-hidden="true" tabindex="-1"></a>Finally, a little wrangling and then save each lookup table. </span>
<span id="cb32-558"><a href="#cb32-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-561"><a href="#cb32-561" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-562"><a href="#cb32-562" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb32-563"><a href="#cb32-563" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb32-564"><a href="#cb32-564" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> split_dfs) {</span>
<span id="cb32-565"><a href="#cb32-565" aria-hidden="true" tabindex="-1"></a>  tmp_ds <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(i)</span>
<span id="cb32-566"><a href="#cb32-566" aria-hidden="true" tabindex="-1"></a>  tmp_name <span class="ot">&lt;-</span> <span class="fu">as.character</span>(i[<span class="dv">1</span>,<span class="dv">1</span>])</span>
<span id="cb32-567"><a href="#cb32-567" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-568"><a href="#cb32-568" aria-hidden="true" tabindex="-1"></a>  tmp_runF <span class="ot">&lt;-</span> tmp_ds <span class="sc">%&gt;%</span> </span>
<span id="cb32-569"><a href="#cb32-569" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(Run, </span>
<span id="cb32-570"><a href="#cb32-570" aria-hidden="true" tabindex="-1"></a>                  Fastq_ID_forward_original, </span>
<span id="cb32-571"><a href="#cb32-571" aria-hidden="true" tabindex="-1"></a>                  Fastq_ID_forward_rename)</span>
<span id="cb32-572"><a href="#cb32-572" aria-hidden="true" tabindex="-1"></a>  tmp_runF<span class="sc">$</span>Run <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb32-573"><a href="#cb32-573" aria-hidden="true" tabindex="-1"></a>  tmp_runF <span class="ot">&lt;-</span> tmp_runF <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"X1"</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"X2"</span> <span class="ot">=</span> <span class="dv">2</span>)</span>
<span id="cb32-574"><a href="#cb32-574" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-575"><a href="#cb32-575" aria-hidden="true" tabindex="-1"></a>  tmp_runR <span class="ot">&lt;-</span> tmp_ds <span class="sc">%&gt;%</span> </span>
<span id="cb32-576"><a href="#cb32-576" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(Run,</span>
<span id="cb32-577"><a href="#cb32-577" aria-hidden="true" tabindex="-1"></a>                  Fastq_ID_reverse_original, </span>
<span id="cb32-578"><a href="#cb32-578" aria-hidden="true" tabindex="-1"></a>                  Fastq_ID_reverse_rename)</span>
<span id="cb32-579"><a href="#cb32-579" aria-hidden="true" tabindex="-1"></a>  tmp_runR<span class="sc">$</span>Run <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb32-580"><a href="#cb32-580" aria-hidden="true" tabindex="-1"></a>  tmp_runR <span class="ot">&lt;-</span> tmp_runR <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"X1"</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"X2"</span> <span class="ot">=</span> <span class="dv">2</span>)</span>
<span id="cb32-581"><a href="#cb32-581" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-582"><a href="#cb32-582" aria-hidden="true" tabindex="-1"></a>  tmp_run <span class="ot">&lt;-</span> <span class="fu">rbind</span>(tmp_runF, tmp_runR)</span>
<span id="cb32-583"><a href="#cb32-583" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(tmp_name, tmp_run)  </span>
<span id="cb32-584"><a href="#cb32-584" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write.table</span>(</span>
<span id="cb32-585"><a href="#cb32-585" aria-hidden="true" tabindex="-1"></a>    tmp_run, </span>
<span id="cb32-586"><a href="#cb32-586" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste</span>(<span class="fu">here</span>(share_here, <span class="st">"fastq_rename_lookup"</span>, tmp_name), </span>
<span id="cb32-587"><a href="#cb32-587" aria-hidden="true" tabindex="-1"></a>          <span class="st">".rename.txt"</span>, <span class="at">sep =</span> <span class="st">""</span>), </span>
<span id="cb32-588"><a href="#cb32-588" aria-hidden="true" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, </span>
<span id="cb32-589"><a href="#cb32-589" aria-hidden="true" tabindex="-1"></a>    <span class="at">quote =</span> <span class="cn">FALSE</span>, </span>
<span id="cb32-590"><a href="#cb32-590" aria-hidden="true" tabindex="-1"></a>    <span class="at">row.names =</span> <span class="cn">FALSE</span>, </span>
<span id="cb32-591"><a href="#cb32-591" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb32-592"><a href="#cb32-592" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb32-593"><a href="#cb32-593" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-594"><a href="#cb32-594" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-595"><a href="#cb32-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-596"><a href="#cb32-596" aria-hidden="true" tabindex="-1"></a>Once we have lookup tables, we can run the bash script called <span class="in">`rename.sh`</span>. This code will take the lookup table and go through each <span class="in">`fastq`</span> file in the run directory and assign the new name. It will also output a timestamped rename results file showing the name changes. The script is run like so: </span>
<span id="cb32-597"><a href="#cb32-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-600"><a href="#cb32-600" aria-hidden="true" tabindex="-1"></a><span class="in">```{bash}</span></span>
<span id="cb32-601"><a href="#cb32-601" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb32-602"><a href="#cb32-602" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb32-603"><a href="#cb32-603" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> rename.sh /path/to/files/ rename_file.txt <span class="pp">[--</span><span class="ss">dry</span><span class="pp">-</span><span class="ss">run</span><span class="pp">]</span></span>
<span id="cb32-604"><a href="#cb32-604" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-605"><a href="#cb32-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-606"><a href="#cb32-606" aria-hidden="true" tabindex="-1"></a>Pass the script a path to the fatsq files and a lookup table. If you just want to see what changes will be made without actually making the changes you can include the flag <span class="in">`--dry-run`</span>. Here is an example from this dataset:</span>
<span id="cb32-607"><a href="#cb32-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-610"><a href="#cb32-610" aria-hidden="true" tabindex="-1"></a><span class="in">```{bash}</span></span>
<span id="cb32-611"><a href="#cb32-611" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb32-612"><a href="#cb32-612" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb32-613"><a href="#cb32-613" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> rename.sh 01_TRIMMED_DATA/BCS_34_Istmo_S1-2_trimmed/ BCS_34.rename.txt</span>
<span id="cb32-614"><a href="#cb32-614" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-615"><a href="#cb32-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-616"><a href="#cb32-616" aria-hidden="true" tabindex="-1"></a>And you should see something like this in the results file: </span>
<span id="cb32-617"><a href="#cb32-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-618"><a href="#cb32-618" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-619"><a href="#cb32-619" aria-hidden="true" tabindex="-1"></a><span class="in">8937-G_R1_001.trimmed.fastq.gz -&gt; EP_A_HEBE_GL_8937_R1.fastq.gz</span></span>
<span id="cb32-620"><a href="#cb32-620" aria-hidden="true" tabindex="-1"></a><span class="in">8937-H_R1_001.trimmed.fastq.gz -&gt; EP_A_HEBE_HP_8937_R1.fastq.gz</span></span>
<span id="cb32-621"><a href="#cb32-621" aria-hidden="true" tabindex="-1"></a><span class="in">8937-M_R1_001.trimmed.fastq.gz -&gt; EP_A_HEBE_MG_8937_R1.fastq.gz</span></span>
<span id="cb32-622"><a href="#cb32-622" aria-hidden="true" tabindex="-1"></a><span class="in">8937-S_R1_001.trimmed.fastq.gz -&gt; EP_A_HEBE_ST_8937_R1.fastq.gz</span></span>
<span id="cb32-623"><a href="#cb32-623" aria-hidden="true" tabindex="-1"></a><span class="in">8938-G_R1_001.trimmed.fastq.gz -&gt; EP_A_HEBE_GL_8938_R1.fastq.gz</span></span>
<span id="cb32-624"><a href="#cb32-624" aria-hidden="true" tabindex="-1"></a><span class="in">8938-H_R1_001.trimmed.fastq.gz -&gt; EP_A_HEBE_HP_8938_R1.fastq.gz</span></span>
<span id="cb32-625"><a href="#cb32-625" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-626"><a href="#cb32-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-627"><a href="#cb32-627" aria-hidden="true" tabindex="-1"></a><span class="fu">## Save Sample Data</span></span>
<span id="cb32-628"><a href="#cb32-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-629"><a href="#cb32-629" aria-hidden="true" tabindex="-1"></a>The last thing to do is define a sample data frame that contains only the most relevant metadata. This table will be used in all downstream analyses to define samples. </span>
<span id="cb32-630"><a href="#cb32-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-633"><a href="#cb32-633" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-634"><a href="#cb32-634" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb32-635"><a href="#cb32-635" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb32-636"><a href="#cb32-636" aria-hidden="true" tabindex="-1"></a>tmp_shortcodes <span class="ot">&lt;-</span> shortcodes[<span class="fu">order</span>(shortcodes<span class="sc">$</span>SampleID), ]</span>
<span id="cb32-637"><a href="#cb32-637" aria-hidden="true" tabindex="-1"></a>tmp_metadata <span class="ot">&lt;-</span> all_metadata[<span class="fu">order</span>(all_metadata<span class="sc">$</span>SampleID), ]</span>
<span id="cb32-638"><a href="#cb32-638" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(tmp_shortcodes<span class="sc">$</span>SampleID, tmp_metadata<span class="sc">$</span>SampleID)</span>
<span id="cb32-639"><a href="#cb32-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-640"><a href="#cb32-640" aria-hidden="true" tabindex="-1"></a>samptab <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(tmp_metadata, tmp_shortcodes, </span>
<span id="cb32-641"><a href="#cb32-641" aria-hidden="true" tabindex="-1"></a>                            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"SampleID"</span>, <span class="st">"Original_name"</span>))</span>
<span id="cb32-642"><a href="#cb32-642" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-643"><a href="#cb32-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-646"><a href="#cb32-646" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-647"><a href="#cb32-647" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb32-648"><a href="#cb32-648" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb32-649"><a href="#cb32-649" aria-hidden="true" tabindex="-1"></a>sample_df <span class="ot">&lt;-</span> samptab <span class="sc">%&gt;%</span></span>
<span id="cb32-650"><a href="#cb32-650" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb32-651"><a href="#cb32-651" aria-hidden="true" tabindex="-1"></a>    <span class="at">SampleID =</span> SampleID,</span>
<span id="cb32-652"><a href="#cb32-652" aria-hidden="true" tabindex="-1"></a>    <span class="at">OCEAN    =</span> Ocean_code,</span>
<span id="cb32-653"><a href="#cb32-653" aria-hidden="true" tabindex="-1"></a>    <span class="at">SPECIES  =</span> Species_code,</span>
<span id="cb32-654"><a href="#cb32-654" aria-hidden="true" tabindex="-1"></a>    <span class="at">TISSUE   =</span> Tissue_code,</span>
<span id="cb32-655"><a href="#cb32-655" aria-hidden="true" tabindex="-1"></a>    <span class="at">ID       =</span> ID,</span>
<span id="cb32-656"><a href="#cb32-656" aria-hidden="true" tabindex="-1"></a>    <span class="at">SITE     =</span> Site,</span>
<span id="cb32-657"><a href="#cb32-657" aria-hidden="true" tabindex="-1"></a>    <span class="at">SITE2    =</span> Site_2,</span>
<span id="cb32-658"><a href="#cb32-658" aria-hidden="true" tabindex="-1"></a>    <span class="at">HABITAT  =</span> Habitat,</span>
<span id="cb32-659"><a href="#cb32-659" aria-hidden="true" tabindex="-1"></a>    <span class="at">TAXON    =</span> Taxon,</span>
<span id="cb32-660"><a href="#cb32-660" aria-hidden="true" tabindex="-1"></a>    <span class="at">PAIR     =</span> Species_pair,</span>
<span id="cb32-661"><a href="#cb32-661" aria-hidden="true" tabindex="-1"></a>    <span class="at">GROUP    =</span> Species_group,</span>
<span id="cb32-662"><a href="#cb32-662" aria-hidden="true" tabindex="-1"></a>    <span class="at">COMPLEX  =</span> Species_complex,</span>
<span id="cb32-663"><a href="#cb32-663" aria-hidden="true" tabindex="-1"></a>    <span class="at">RUN      =</span> Run,</span>
<span id="cb32-664"><a href="#cb32-664" aria-hidden="true" tabindex="-1"></a>    <span class="at">PLATE    =</span> Plate</span>
<span id="cb32-665"><a href="#cb32-665" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb32-666"><a href="#cb32-666" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-667"><a href="#cb32-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-668"><a href="#cb32-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-669"><a href="#cb32-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-670"><a href="#cb32-670" aria-hidden="true" tabindex="-1"></a>Moving on. </span>
<span id="cb32-671"><a href="#cb32-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-672"><a href="#cb32-672" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!------------------------------------------------------------------------&gt;</span></span>
<span id="cb32-673"><a href="#cb32-673" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-------------------- Use this area to save things ----------------------&gt;</span></span>
<span id="cb32-674"><a href="#cb32-674" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!------------------------------------------------------------------------&gt;</span></span>
<span id="cb32-675"><a href="#cb32-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-676"><a href="#cb32-676" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!---------------------------------------&gt;</span></span>
<span id="cb32-677"><a href="#cb32-677" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- These chunks are for curated data --&gt;</span></span>
<span id="cb32-678"><a href="#cb32-678" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!---------------------------------------&gt;</span></span>
<span id="cb32-679"><a href="#cb32-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-682"><a href="#cb32-682" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-683"><a href="#cb32-683" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb32-684"><a href="#cb32-684" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb32-685"><a href="#cb32-685" aria-hidden="true" tabindex="-1"></a><span class="fu">write_delim</span>(all_metadata, <span class="fu">here</span>(work_here, <span class="st">"all_metadata.txt"</span>), <span class="at">delim =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span>
<span id="cb32-686"><a href="#cb32-686" aria-hidden="true" tabindex="-1"></a><span class="fu">write_delim</span>(sample_df, <span class="fu">here</span>(work_here, <span class="st">"sample_data.txt"</span>), <span class="at">delim =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span>
<span id="cb32-687"><a href="#cb32-687" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(sample_df, <span class="fu">here</span>(work_here, <span class="st">"sample_data.rds"</span>))</span>
<span id="cb32-688"><a href="#cb32-688" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-689"><a href="#cb32-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-690"><a href="#cb32-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-693"><a href="#cb32-693" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-694"><a href="#cb32-694" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb32-695"><a href="#cb32-695" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb32-696"><a href="#cb32-696" aria-hidden="true" tabindex="-1"></a><span class="fu">file.copy</span>(<span class="fu">here</span>(work_here,  <span class="st">"all_metadata.txt"</span>), </span>
<span id="cb32-697"><a href="#cb32-697" aria-hidden="true" tabindex="-1"></a>          <span class="fu">here</span>(share_here), </span>
<span id="cb32-698"><a href="#cb32-698" aria-hidden="true" tabindex="-1"></a>          <span class="at">overwrite =</span> <span class="cn">TRUE</span>, <span class="at">recursive =</span> <span class="cn">FALSE</span>, </span>
<span id="cb32-699"><a href="#cb32-699" aria-hidden="true" tabindex="-1"></a>          <span class="at">copy.mode =</span> <span class="cn">TRUE</span>, <span class="at">copy.date =</span> <span class="cn">FALSE</span>)</span>
<span id="cb32-700"><a href="#cb32-700" aria-hidden="true" tabindex="-1"></a><span class="fu">file.copy</span>(<span class="fu">here</span>(work_here,  <span class="st">"sample_data.rds"</span>), </span>
<span id="cb32-701"><a href="#cb32-701" aria-hidden="true" tabindex="-1"></a>          <span class="fu">here</span>(share_here), </span>
<span id="cb32-702"><a href="#cb32-702" aria-hidden="true" tabindex="-1"></a>          <span class="at">overwrite =</span> <span class="cn">TRUE</span>, <span class="at">recursive =</span> <span class="cn">FALSE</span>, </span>
<span id="cb32-703"><a href="#cb32-703" aria-hidden="true" tabindex="-1"></a>          <span class="at">copy.mode =</span> <span class="cn">TRUE</span>, <span class="at">copy.date =</span> <span class="cn">FALSE</span>)</span>
<span id="cb32-704"><a href="#cb32-704" aria-hidden="true" tabindex="-1"></a><span class="fu">file.copy</span>(<span class="fu">here</span>(work_here,  <span class="st">"sample_data.txt"</span>), </span>
<span id="cb32-705"><a href="#cb32-705" aria-hidden="true" tabindex="-1"></a>          <span class="fu">here</span>(share_here), </span>
<span id="cb32-706"><a href="#cb32-706" aria-hidden="true" tabindex="-1"></a>          <span class="at">overwrite =</span> <span class="cn">TRUE</span>, <span class="at">recursive =</span> <span class="cn">FALSE</span>, </span>
<span id="cb32-707"><a href="#cb32-707" aria-hidden="true" tabindex="-1"></a>          <span class="at">copy.mode =</span> <span class="cn">TRUE</span>, <span class="at">copy.date =</span> <span class="cn">FALSE</span>)</span>
<span id="cb32-708"><a href="#cb32-708" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-709"><a href="#cb32-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-710"><a href="#cb32-710" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--------------------------------------------&gt;</span></span>
<span id="cb32-711"><a href="#cb32-711" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- These chunks are for  processing data  --&gt;</span></span>
<span id="cb32-712"><a href="#cb32-712" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--------------------------------------------&gt;</span></span>
<span id="cb32-713"><a href="#cb32-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-716"><a href="#cb32-716" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-717"><a href="#cb32-717" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb32-718"><a href="#cb32-718" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb32-719"><a href="#cb32-719" aria-hidden="true" tabindex="-1"></a>workflow_name <span class="ot">&lt;-</span> <span class="st">"sampledata"</span></span>
<span id="cb32-720"><a href="#cb32-720" aria-hidden="true" tabindex="-1"></a>work_here</span>
<span id="cb32-721"><a href="#cb32-721" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(<span class="fu">here</span>(share_here, <span class="fu">paste0</span>(workflow_name, <span class="st">"_processing"</span>)), </span>
<span id="cb32-722"><a href="#cb32-722" aria-hidden="true" tabindex="-1"></a>           <span class="at">recursive =</span> <span class="cn">FALSE</span>, <span class="at">showWarnings =</span> <span class="cn">TRUE</span>)</span>
<span id="cb32-723"><a href="#cb32-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-724"><a href="#cb32-724" aria-hidden="true" tabindex="-1"></a>tmp_processing <span class="ot">&lt;-</span> <span class="fu">here</span>(share_here, <span class="fu">paste0</span>(workflow_name, <span class="st">"_processing/"</span>))</span>
<span id="cb32-725"><a href="#cb32-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-726"><a href="#cb32-726" aria-hidden="true" tabindex="-1"></a>fs<span class="sc">::</span><span class="fu">dir_copy</span>(<span class="at">path =</span> <span class="fu">here</span>(work_here,  <span class="st">"metadata_files/"</span>), </span>
<span id="cb32-727"><a href="#cb32-727" aria-hidden="true" tabindex="-1"></a>             <span class="at">new_path =</span> <span class="fu">here</span>(<span class="fu">paste0</span>(tmp_processing, <span class="st">"metadata_files/"</span>)), </span>
<span id="cb32-728"><a href="#cb32-728" aria-hidden="true" tabindex="-1"></a>             <span class="at">overwrite =</span> <span class="cn">TRUE</span>)</span>
<span id="cb32-729"><a href="#cb32-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-730"><a href="#cb32-730" aria-hidden="true" tabindex="-1"></a><span class="fu">file.copy</span>(<span class="fu">here</span>(work_here,  <span class="st">"fastq_info.txt"</span>), </span>
<span id="cb32-731"><a href="#cb32-731" aria-hidden="true" tabindex="-1"></a>          <span class="fu">here</span>(tmp_processing), </span>
<span id="cb32-732"><a href="#cb32-732" aria-hidden="true" tabindex="-1"></a>          <span class="at">overwrite =</span> <span class="cn">TRUE</span>, <span class="at">recursive =</span> <span class="cn">FALSE</span>, </span>
<span id="cb32-733"><a href="#cb32-733" aria-hidden="true" tabindex="-1"></a>          <span class="at">copy.mode =</span> <span class="cn">TRUE</span>, <span class="at">copy.date =</span> <span class="cn">FALSE</span>)</span>
<span id="cb32-734"><a href="#cb32-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-735"><a href="#cb32-735" aria-hidden="true" tabindex="-1"></a>fs<span class="sc">::</span><span class="fu">dir_copy</span>(<span class="at">path =</span> <span class="fu">here</span>(work_here,  <span class="st">"fastq_rename_lookup/"</span>), </span>
<span id="cb32-736"><a href="#cb32-736" aria-hidden="true" tabindex="-1"></a>             <span class="at">new_path =</span> <span class="fu">here</span>(<span class="fu">paste0</span>(tmp_processing, <span class="st">"fastq_rename_lookup/"</span>)), </span>
<span id="cb32-737"><a href="#cb32-737" aria-hidden="true" tabindex="-1"></a>             <span class="at">overwrite =</span> <span class="cn">TRUE</span>)</span>
<span id="cb32-738"><a href="#cb32-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-739"><a href="#cb32-739" aria-hidden="true" tabindex="-1"></a><span class="fu">file.copy</span>(<span class="fu">here</span>(work_here,  <span class="st">"rename.sh"</span>), </span>
<span id="cb32-740"><a href="#cb32-740" aria-hidden="true" tabindex="-1"></a>          <span class="fu">here</span>(tmp_processing), </span>
<span id="cb32-741"><a href="#cb32-741" aria-hidden="true" tabindex="-1"></a>          <span class="at">overwrite =</span> <span class="cn">TRUE</span>, <span class="at">recursive =</span> <span class="cn">FALSE</span>, </span>
<span id="cb32-742"><a href="#cb32-742" aria-hidden="true" tabindex="-1"></a>          <span class="at">copy.mode =</span> <span class="cn">TRUE</span>, <span class="at">copy.date =</span> <span class="cn">FALSE</span>)</span>
<span id="cb32-743"><a href="#cb32-743" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-744"><a href="#cb32-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-747"><a href="#cb32-747" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-748"><a href="#cb32-748" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb32-749"><a href="#cb32-749" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb32-750"><a href="#cb32-750" aria-hidden="true" tabindex="-1"></a>zip<span class="sc">::</span><span class="fu">zip</span>(<span class="at">zipfile =</span> <span class="fu">here</span>(share_here, <span class="fu">paste0</span>(workflow_name, <span class="st">"_processing.zip"</span>)), </span>
<span id="cb32-751"><a href="#cb32-751" aria-hidden="true" tabindex="-1"></a>         <span class="at">files =</span> <span class="fu">here</span>(share_here,  <span class="fu">paste0</span>(workflow_name, <span class="st">"_processing"</span>)), </span>
<span id="cb32-752"><a href="#cb32-752" aria-hidden="true" tabindex="-1"></a>         <span class="at">mode =</span> <span class="st">"cherry-pick"</span>)</span>
<span id="cb32-753"><a href="#cb32-753" aria-hidden="true" tabindex="-1"></a><span class="fu">dir_delete</span>(<span class="fu">here</span>(share_here, <span class="fu">paste0</span>(workflow_name, <span class="st">"_processing"</span>)))</span>
<span id="cb32-754"><a href="#cb32-754" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-755"><a href="#cb32-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-756"><a href="#cb32-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-759"><a href="#cb32-759" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-760"><a href="#cb32-760" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb32-761"><a href="#cb32-761" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb32-762"><a href="#cb32-762" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>()</span>
<span id="cb32-763"><a href="#cb32-763" aria-hidden="true" tabindex="-1"></a>gdata<span class="sc">::</span><span class="fu">keep</span>(all_metadata, </span>
<span id="cb32-764"><a href="#cb32-764" aria-hidden="true" tabindex="-1"></a>            BCS_26, BCS_28, BCS_29, </span>
<span id="cb32-765"><a href="#cb32-765" aria-hidden="true" tabindex="-1"></a>            BCS_30, BCS_34, BCS_35,  </span>
<span id="cb32-766"><a href="#cb32-766" aria-hidden="true" tabindex="-1"></a>            dups_in_md, shortcodes,</span>
<span id="cb32-767"><a href="#cb32-767" aria-hidden="true" tabindex="-1"></a>            head_short, head_split_dfs, </span>
<span id="cb32-768"><a href="#cb32-768" aria-hidden="true" tabindex="-1"></a>            sample_df, samptab, </span>
<span id="cb32-769"><a href="#cb32-769" aria-hidden="true" tabindex="-1"></a>            <span class="at">sure =</span> <span class="cn">TRUE</span>)</span>
<span id="cb32-770"><a href="#cb32-770" aria-hidden="true" tabindex="-1"></a><span class="fu">save.image</span>(<span class="fu">here</span>(<span class="st">"page_build"</span>, <span class="st">"ssu_sampledata.rdata"</span>))</span>
<span id="cb32-771"><a href="#cb32-771" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-772"><a href="#cb32-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-773"><a href="#cb32-773" aria-hidden="true" tabindex="-1"></a>{{&lt; include /include/_footer.qmd &gt;}}</span>
</code></pre></div><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>Site constructed using <a href="https://quarto.org/">Quarto</a>.</p>
</div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
<li class="nav-item">
    <a class="nav-link" href="../../../site_info.html">
<p>Site Information</p>
</a>
  </li>  
</ul>
<div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/istmobiome/trans-shrimp/blob/main/workflows/ssu/sampledata/index.qmd" target="_blank" class="toc-action"><i class="bi bi-github"></i>View source</a></li><li><a href="https://github.com/istmobiome/trans-shrimp/edit/main/workflows/ssu/sampledata/index.qmd" target="_blank" class="toc-action"><i class="bi empty"></i>Edit this page</a></li><li><a href="https://github.com/istmobiome/trans-shrimp/issues/new" target="_blank" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>© Copyright 2025 <a href="https://metacrobe.github.io/">metacrobe</a> &amp; <a href="https://istmobiome.rbind.io/">The Istmobiome Project</a>.</p>
</div>
  </div>
</footer>


</body></html>